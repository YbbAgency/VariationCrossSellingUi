{"remainingRequest":"/Users/lennart/VueProjekte/plentyui/VariationCrossSellingUi/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lennart/VueProjekte/plentyui/VariationCrossSellingUi/src/components/Main.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lennart/VueProjekte/plentyui/VariationCrossSellingUi/src/components/Main.vue","mtime":1686838570454},{"path":"/Users/lennart/VueProjekte/plentyui/VariationCrossSellingUi/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lennart/VueProjekte/plentyui/VariationCrossSellingUi/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/lennart/VueProjekte/plentyui/VariationCrossSellingUi/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lennart/VueProjekte/plentyui/VariationCrossSellingUi/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBQbGVudHlJbnB1dFNlYXJjaCBmcm9tICIuL0lucHV0L3BsZW50eUlucHV0U2VhcmNoIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdNYWluJywKICBjb21wb25lbnRzOiB7UGxlbnR5SW5wdXRTZWFyY2h9LAogIGRhdGE6ICgpID0+ICgKICAgICAgewogICAgICAgIHJ1bGVzOiB7CiAgICAgICAgICBub3RTYW1lOiB2YWx1ZSA9PiB2YWx1ZSA9PSB2YWx1ZSwKICAgICAgICAgIGdyZWF0ZXJaZXJvOiB2YWx1ZSA9PiB2YWx1ZSA+IDAgLAogICAgICAgIH0sCiAgICAgICAgc2VhcmNoUmVzdWx0c1RvdGFsOjAsCiAgICAgICAgdXNlQ2F0ZWdvcmllczp0cnVlLAogICAgICAgIG1hcmsxSXRlbXM6WycnLCJPaG5lIiwxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMCwgMTEsIDEyLCAxMywgMTQsIDE1LCAxNiwgMTcsIDE4LCAxOSwgMjAsIDIxLCAyMiwgMjMsIDI0LCAyNSwgMjYsIDI3LCAyOCwgMjksIDMwLCAzMV0sCiAgICAgICAgbWFyazJJdGVtczpbJycsIk9obmUiLDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMV0sCiAgICAgICAgdGFnczpbXSwKICAgICAgICBzZWxlY3RlZFRhZ3M6W10sCiAgICAgICAgdG90YWxDcm9zc1NlbGxlcjowLAogICAgICAgIG1vZGFsOgogICAgICAgIHsKICAgICAgICAgIGRlbGV0ZUFsbDpmYWxzZQogICAgICAgIH0sCiAgICAgICAgc2VhcmNoT3B0aW9uczp7CiAgICAgICAgICBwYWdlOjEsCiAgICAgICAgICBpdGVtc1BlclBhZ2U6MTUsCiAgICAgICAgfSwKICAgICAgICBvcHRpb25zOgogICAgICAgIHsKICAgICAgICAgIHBhZ2U6MSwKICAgICAgICAgIGl0ZW1zUGVyUGFnZToxNSwKICAgICAgICAgIG9yZGVyQnk6J3ZhcklkJywKICAgICAgICAgIGZpbHRlcjpbXSwKICAgICAgICB9LAogICAgICAgIGFjdGlvbnM6CiAgICAgICAgewogICAgICAgICAgZm9jdXNTZWFyY2g6IGZhbHNlLAogICAgICAgICAgZm9jdXNGaWx0ZXI6IGZhbHNlCiAgICAgICAgfSwKICAgICAgICBzZWFyY2hTZWxlY3Q6CiAgICAgICAgWwogICAgICAgICAgewogICAgICAgICAgICAia2V5IjogInZhcklkIiwKICAgICAgICAgICAgIm5hbWUiOiAnVmFyaWFudGVuIElkOicsCiAgICAgICAgICAgICJvcGVyYXRvciI6ICI9IiwKICAgICAgICAgICAgInZhbHVlIjogJycsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICAia2V5IjogIml0ZW1JZCIsCiAgICAgICAgICAgICJuYW1lIjogJ0FydGlrZWwgSWQ6JywKICAgICAgICAgICAgIm9wZXJhdG9yIjogIj0iLAogICAgICAgICAgICAidmFsdWUiOiAnJywKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgICJrZXkiOiAidmFyTnVtYmVyIiwKICAgICAgICAgICAgIm5hbWUiOiAnVmFyaWFudGVuIE51bW1lcjonLAogICAgICAgICAgICAib3BlcmF0b3IiOiAiPSIsCiAgICAgICAgICAgICJ2YWx1ZSI6ICcnLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgImtleSI6ICJ2YXJOYW1lIiwKICAgICAgICAgICAgIm5hbWUiOiAnVmFyaWFudGVuIE5hbWU6JywKICAgICAgICAgICAgIm9wZXJhdG9yIjogIj0iLAogICAgICAgICAgICAidmFsdWUiOiAnJywKICAgICAgICAgIH0KCiAgICAgICAgXSwKICAgICAgICBzZWFyY2hGaWx0ZXJJbnB1dFNlYXJjaDoKICAgICAgICBbCiAgICAgICAgXSwKICAgICAgICBtYWluVGFiczogMCwKICAgICAgICB0YWJTZWFyY2g6IDAsCiAgICAgICAgY2F0ZWdvcnlUcmVlOiBbXSwKICAgICAgICBzZWxlY3RJdGVtczogewogICAgICAgICAgbWFuZGFudDogW10sCiAgICAgICAgICBtYW51ZmFjdHVyZXI6IFtdLAogICAgICAgICAgaXNBY3RpdmU6WwogICAgICAgICAgICAnQUxMRScsCiAgICAgICAgICAgICdKQScsCiAgICAgICAgICAgICdORUlOJwogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgbWFuZGFudE1hcDoge30sCiAgICAgICAgbWFudWZhY3R1cmVyTWFwOiB7fSwKICAgICAgICBzZWxlY3RlZFZhcmlhdGlvbjoKICAgICAgICAgICAgewogICAgICAgICAgICB9LAogICAgICAgIHNlYXJjaGluZ1ZhcmlhbnRUb1NlbGVjdDpmYWxzZSwKICAgICAgICBjdXJyZW50Q3Jvc3NTZWxsZXI6W10sCiAgICAgICAgc2VhcmNoUmVzdWx0SGVhZGVyOgogICAgICAgICAgICBbCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGV4dDonJywKICAgICAgICAgICAgICAgIHNvcnRhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIHZhbHVlOidpbWFnZScKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRleHQ6ICdWYXJpYW50ZW4tSWQnLAogICAgICAgICAgICAgICAgc29ydGFibGU6IHRydWUsCiAgICAgICAgICAgICAgICB2YWx1ZTogJ3ZhcklkJywKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRleHQ6ICdBcnRpa2VsLUlkJywKICAgICAgICAgICAgICAgIHNvcnRhYmxlOiB0cnVlLAogICAgICAgICAgICAgICAgdmFsdWU6ICdpdGVtSWQnLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGV4dDogJ05hbWUnLAogICAgICAgICAgICAgICAgc29ydGFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgdmFsdWU6ICdpdGVtTmFtZScsCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0ZXh0OiAndGFncycsCiAgICAgICAgICAgICAgICBzb3J0YWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICB2YWx1ZTogJ3RhZ3MnLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGV4dDonSGVyc3RlbGxlcicsCiAgICAgICAgICAgICAgICBzb3J0YWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICB2YWx1ZTonbWFudWZhY3R1cmVyJwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgXSwKICAgICAgICBzZWFyY2hSZXN1bHRzOltdLAogICAgICAgIHNlYXJjaEZpbHRlcjoKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNhdGVnb3JpZXM6W10sCiAgICAgICAgICAgICAgaXRlbUlkOm51bGwsCiAgICAgICAgICAgICAgdmFySWQ6bnVsbCwKICAgICAgICAgICAgICB2YXJOdW1iZXI6bnVsbCwKICAgICAgICAgICAgICBpdGVtRGF0YTonJywKICAgICAgICAgICAgICBtYW51ZmFjdHVyZXI6MCwKICAgICAgICAgICAgICBtYW5kYW50OjAsCiAgICAgICAgICAgICAgaXNBY3RpdmU6J0pBJywKICAgICAgICAgICAgICBtYXJrMTotMSwKICAgICAgICAgICAgICBtYXJrMjotMQogICAgICAgICAgICB9LAogICAgICAgIGxvYWRpbmc6ewogICAgICAgICAgZHluYW1pY0dldDpmYWxzZSwKICAgICAgICAgIGNyb3NzU2VsbGVyOmZhbHNlLAogICAgICAgICAgZGFzaGJvYXJkOnRydWUsCiAgICAgICAgICBzZWFyY2g6ZmFsc2UsCiAgICAgICAgICBkZWxldGU6ZmFsc2UsCiAgICAgICAgICBhZGQ6ZmFsc2UsCiAgICAgICAgICBwb3NpdGlvbjpmYWxzZSwKICAgICAgICAgIGRhc2hib2FyZFNlYXJjaDpmYWxzZQogICAgICAgIH0sCiAgICAgICAgc2VsZWN0ZWQ6W10sCiAgICAgICAgZGFzaGJvYXJkQ3Jvc3NTZWxsZXI6W10sCiAgICAgICAgYWxlcnRzOiB7CiAgICAgICAgICBkYXNoYm9hcmRTZWFyY2g6CiAgICAgICAgICB7CiAgICAgICAgICAgIG1lc3NhZ2U6JycsCiAgICAgICAgICAgICAgICBpc0FjdGl2ZTpmYWxzZSwKICAgICAgICAgICAgICB0eXBlOicnCiAgICAgICAgICB9LAogICAgICAgICAgYWRkOiB7CiAgICAgICAgICAgIG1lc3NhZ2U6JycsCiAgICAgICAgICAgIGlzQWN0aXZlOmZhbHNlLAogICAgICAgICAgICB0eXBlOicnCiAgICAgICAgICB9LAogICAgICAgICAgc2VhcmNoOnsKICAgICAgICAgICAgbWVzc2FnZTonJywKICAgICAgICAgICAgaXNBY3RpdmU6ZmFsc2UsCiAgICAgICAgICAgIHR5cGU6JycKICAgICAgICAgIH0sCiAgICAgICAgICBkZWxldGU6ewogICAgICAgICAgICBtZXNzYWdlOicnLAogICAgICAgICAgICBpc0FjdGl2ZTpmYWxzZSwKICAgICAgICAgICAgdHlwZTonJwogICAgICAgICAgfSwKICAgICAgICAgIHBvc2l0aW9uOnsKICAgICAgICAgICAgbWVzc2FnZTonJywKICAgICAgICAgICAgaXNBY3RpdmU6ZmFsc2UsCiAgICAgICAgICAgIHR5cGU6JycKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pLAogIHdhdGNoOgogICAgICB7CgogICAgICB9LAogIGNyZWF0ZWQoKSB7CgogICAgdGhpcy5nZXRJbml0aWFsRGF0YSgpCgogIH0sCiAgbWV0aG9kczoKICAgICAgewogICAgICAgIHNldENsYXNzQWxyZWFkeUNyb3NzU2VsbGVyKGl0ZW0pCiAgICAgICAgewogICAgICAgICAgaWYodGhpcy5hbHJlYWR5Q3Jvc3NTZWxsZXIoaXRlbS52YXJJZCkgPT0gdHJ1ZSAmJiB0aGlzLnNlYXJjaGluZ1ZhcmlhbnRUb1NlbGVjdCAhPT0gdHJ1ZSAgfHwgIGl0ZW0udmFySWQgPT0gdGhpcy5zZWxlY3RlZFZhcmlhdGlvbi52YXJJZCkKICAgICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuICdhbHJlYWR5Q3Jvc3NTZWxsZXInCiAgICAgICAgICB9CiAgICAgICAgICBlbHNlewogICAgICAgICAgICByZXR1cm4gJycKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGFscmVhZHlDcm9zc1NlbGxlcih2YXJJZCkKICAgICAgICB7CiAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgdGhpcy5jdXJyZW50Q3Jvc3NTZWxsZXIubGVuZ3RoOyBpKyspCiAgICAgICAgICB7CiAgICAgICAgICAgIGlmKHZhcklkID09IHRoaXMuY3VycmVudENyb3NzU2VsbGVyW2ldLnZhcklkKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9LAogICAgICAgIGRlbGV0ZUNyb3NzU2VsbGVyKHZhcnMpCiAgICAgICAgewogICAgICAgICAgbGV0IF9zZWxmID0gdGhpczsKCiAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgZGVsZXRlRnJvbTpfc2VsZi5zZWxlY3RlZFZhcmlhdGlvbi52YXJJZCwKICAgICAgICAgICAgdG9EZWxldGU6W10KICAgICAgICAgIH0KCiAgICAgICAgICBsZXQgcmVwbGFjZSAgPSBbXTsKCgogICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHZhcnMubGVuZ3RoOyBpKyspCiAgICAgICAgICB7CiAgICAgICAgICAgIGRhdGEudG9EZWxldGUucHVzaCh2YXJzW2ldKQogICAgICAgICAgfQoKICAgICAgICAgIGZvcihsZXQgaSA9IDAgOyBpIDwgdGhpcy5jdXJyZW50Q3Jvc3NTZWxsZXIubGVuZ3RoIDsgaSsrKQogICAgICAgICAgewogICAgICAgICAgICBmb3IobGV0IGEgPSAwIDsgYSA8ICBkYXRhLnRvRGVsZXRlLmxlbmd0aCA7IGErKykKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlmKHRoaXMuY3VycmVudENyb3NzU2VsbGVyW2ldLnZhcklkID09IGRhdGEudG9EZWxldGVbYV0udmFySWQpCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Q3Jvc3NTZWxsZXIuc3BsaWNlKGksMSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCgogICAgICAgICAgX3NlbGYuJGh0dHAucG9zdCggcHJvY2Vzcy5lbnYuVlVFX0FQUF9ERUxFVEVfQ1JPU1NTRUxMRVIrcHJvY2Vzcy5lbnYuVlVFX0FQUF9QTFVHSU5fU0VUX1BSRVZJRVcsZGF0YSkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgaWYocmVzcG9uc2UpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBfc2VsZi5hbGVydHMuZGVsZXRlLmlzQWN0aXZlID0gdHJ1ZTsKICAgICAgICAgICAgICBfc2VsZi5hbGVydHMuZGVsZXRlLnR5cGUgPSAnc3VjY2Vzcyc7CiAgICAgICAgICAgICAgX3NlbGYuYWxlcnRzLmRlbGV0ZS5tZXNzYWdlID0gIkNyb3NzIFNlbGxlciB3dXJkZSBlcmZvbGdyZWljaCBnZWzDtnNjaHQiCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgICBfc2VsZi5hbGVydHMuZGVsZXRlLmlzQWN0aXZlID0gdHJ1ZTsKICAgICAgICAgICAgX3NlbGYuYWxlcnRzLmRlbGV0ZS50eXBlID0gJ2Vycm9yJzsKICAgICAgICAgICAgX3NlbGYuYWxlcnRzLmRlbGV0ZS5tZXNzYWdlID0gIkNyb3NzIFNlbGxlciBrb25udGVuIG5pY2h0IGdlbMO2c2NodCB3ZXJkZW4iCiAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgcmVzZXRTZWFyY2goKQogICAgICAgIHsKICAgICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBbXTsKICAgICAgICAgIHRoaXMuc2VhcmNoUmVzdWx0cyA9IFtdOwogICAgICAgICAgdGhpcy5zZWFyY2hGaWx0ZXIgPSB7CiAgICAgICAgICAgIGNhdGVnb3JpZXM6W10sCiAgICAgICAgICAgIGl0ZW1JZDpudWxsLAogICAgICAgICAgICB2YXJJZDpudWxsLAogICAgICAgICAgICB2YXJOdW1iZXI6bnVsbCwKICAgICAgICAgICAgaXRlbURhdGE6JycsCiAgICAgICAgICAgIG1hbnVmYWN0dXJlcjowLAogICAgICAgICAgICBtYW5kYW50OjAsCiAgICAgICAgICAgIGlzQWN0aXZlOidKQScsCiAgICAgICAgICAgIG1hcmsyOi0xLAogICAgICAgICAgICBtYXJrMTotMQogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMubWFpblRhYnMgPSAyOwogICAgICAgIH0sCiAgICAgICAgc2V0Q3Jvc3NTZWxsZXJDb250cm9sbGVyKGV2ZW50KQogICAgICAgIHsKICAgICAgICAgIGxldCBfc2VsZiA9IHRoaXM7CgogICAgICAgICAgaWYoX3NlbGYuc2VhcmNoaW5nVmFyaWFudFRvU2VsZWN0ID09IHRydWUpewogICAgICAgICAgICBpZihldmVudC5pc1NlbGVjdGFibGUgPT0gdHJ1ZSkgewogICAgICAgICAgICAgIHRoaXMuc2V0TmV3VmFyaWFudChldmVudCkKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgZWxzZXsKICAgICAgICAgICAgaWYoZXZlbnQuaXNTZWxlY3RhYmxlID09IHRydWUpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICB0aGlzLmFkZE5ld0Nyb3NzU2VsbGVyKFtldmVudF0pCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgfSwKICAgICAgICBzZXROZXdWYXJpYW50KGRhdGEpCiAgICAgICAgewogICAgICAgICAgdGhpcy5nZXRDcm9zc1NlbGxlckJ5SWQoZGF0YS52YXJJZCkKICAgICAgICB9LAogICAgICAgIGFkZE5ld0Nyb3NzU2VsbGVyKHZhcnMpCiAgICAgICAgewogICAgICAgICAgbGV0IF9zZWxmID0gdGhpczsKCiAgICAgICAgICBfc2VsZi5sb2FkaW5nLmFkZCA9IHRydWU7CgogICAgICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgICAgIGFkZFRvOnsKICAgICAgICAgICAgICB2YXJJZDpfc2VsZi5zZWxlY3RlZFZhcmlhdGlvbi52YXJJZCwKICAgICAgICAgICAgICBpdGVtSWQ6X3NlbGYuc2VsZWN0ZWRWYXJpYXRpb24uaXRlbUlkLAogICAgICAgICAgICAgIGl0ZW1OYW1lOl9zZWxmLnNlbGVjdGVkVmFyaWF0aW9uLml0ZW1OYW1lLAogICAgICAgICAgICAgIG1hbnVmYWN0dXJlcjpfc2VsZi5zZWxlY3RlZFZhcmlhdGlvbi5tYW51ZmFjdHVyZXIsCiAgICAgICAgICAgICAgZXh0ZXJuYWxWYXJJZDpfc2VsZi5zZWxlY3RlZFZhcmlhdGlvbi5leHRlcm5hbElkLAogICAgICAgICAgICAgIHZhck51bWJlcjpfc2VsZi5zZWxlY3RlZFZhcmlhdGlvbi52YXJOdW1iZXIsCiAgICAgICAgICAgICAgY2xpZW50Ol9zZWxmLnNlbGVjdGVkVmFyaWF0aW9uLmNsaWVudAogICAgICAgICAgICB9LAogICAgICAgICAgICB0b0FkZDpbXQogICAgICAgICAgfQoKICAgICAgICAgIGxldCBoaWdoZXN0UG9zID0gMDsKCiAgICAgICAgICBmb3IobGV0IGkgPSAwIDsgaSA8ICBfc2VsZi5jdXJyZW50Q3Jvc3NTZWxsZXIubGVuZ3RoIDsgaSsrKQogICAgICAgICAgewogICAgICAgICAgICBpZihfc2VsZi5jdXJyZW50Q3Jvc3NTZWxsZXJbaV0ucG9zaXRpb24gPiBoaWdoZXN0UG9zKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgaGlnaGVzdFBvcyA9IF9zZWxmLmN1cnJlbnRDcm9zc1NlbGxlcltpXS5wb3NpdGlvbjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB2YXJzLmxlbmd0aDsgaSsrKQogICAgICAgICAgewogICAgICAgICAgICBkYXRhLnRvQWRkLnB1c2goCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIHZhcklkOnZhcnNbaV0udmFySWQsCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOmhpZ2hlc3RQb3MrMQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApCgogICAgICAgICAgICB2YXJzW2ldLnBvc2l0aW9uID0gaGlnaGVzdFBvcysxOwoKICAgICAgICAgICAgaGlnaGVzdFBvcysrOwogICAgICAgICAgfQoKICAgICAgICAgIF9zZWxmLiRodHRwLnBvc3QoIHByb2Nlc3MuZW52LlZVRV9BUFBfQUREX0NST1NTU0VMTEVSK3Byb2Nlc3MuZW52LlZVRV9BUFBfUExVR0lOX1NFVF9QUkVWSUVXLGRhdGEpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgIGlmKHJlc3BvbnNlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgX3NlbGYubWFpblRhYnMgPSAxOwogICAgICAgICAgICAgIF9zZWxmLmFsZXJ0cy5hZGQuaXNBY3RpdmUgPSB0cnVlOwogICAgICAgICAgICAgIF9zZWxmLmxvYWRpbmcuYWRkID0gZmFsc2U7CiAgICAgICAgICAgICAgX3NlbGYuYWxlcnRzLmFkZC50eXBlID0gJ3N1Y2Nlc3MnOwogICAgICAgICAgICAgIF9zZWxmLmFsZXJ0cy5hZGQubWVzc2FnZSA9ICJDcm9zcyBTZWxsZXIgd3VyZGVuIGVyZm9sZ3JlaWNoIHZlcmtuw7xwZnQiCiAgICAgICAgICAgICAgX3NlbGYuZ2V0Q3Jvc3NTZWxsZXJCeUlkKF9zZWxmLnNlbGVjdGVkVmFyaWF0aW9uLnZhcklkKQogICAgICAgICAgICB9CiAgICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgICAgX3NlbGYubG9hZGluZy5hZGQgPSBmYWxzZTsKICAgICAgICAgICAgX3NlbGYuYWxlcnRzLmFkZC50eXBlID0gJ2Vycm9yJzsKICAgICAgICAgICAgX3NlbGYuYWxlcnRzLmFkZC5pc0FjdGl2ZSA9IHRydWU7CiAgICAgICAgICAgIF9zZWxmLmFsZXJ0cy5hZGQubWVzc2FnZSA9ICJDcm9zcyBTZWxsZXIga29ubnRlbiBuaWNodCB2ZXJrbsO8cGZ0IHdlcmRlbiIKICAgICAgICAgICAgLy8gX3NlbGYubXlBbGVydHMuZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAvLyBfc2VsZi5teUFsZXJ0cy5lcnJvck1lc3NhZ2UgPSBlcnJvcgogICAgICAgICAgICAvLyBfc2VsZi5yZXNldEVyb3JyKCk7CiAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgZ2V0Q3Jvc3NTZWxsZXJCeUlkKHZhcklkKQogICAgICAgIHsKICAgICAgICAgIGxldCBfc2VsZiA9IHRoaXM7CgogICAgICAgICAgX3NlbGYubG9hZGluZy5jcm9zc1NlbGxlciA9IHRydWU7CgogICAgICAgICAgX3NlbGYuY3VycmVudENyb3NzU2VsbGVyID0gW107CgogICAgICAgICAgX3NlbGYubWFpblRhYnMgPSAxOwoKICAgICAgICAgIF9zZWxmLiRodHRwLmdldCggcHJvY2Vzcy5lbnYuVlVFX0FQUF9HRVRfQ1JPU1NTRUxMRVIrdmFySWQrJy8nKydkZScrJy8nKzArcHJvY2Vzcy5lbnYuVlVFX0FQUF9QTFVHSU5fU0VUX1BSRVZJRVcpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgIGlmKHJlc3BvbnNlKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Nyb3NzYnlpZCcscmVzcG9uc2UpCiAgICAgICAgICAgICAgbGV0IHNlbGVjdFZhciA9IHJlc3BvbnNlLmRhdGEuc2VsZWN0ZWRWYXIuZGF0YTsKCiAgICAgICAgICAgICAgbGV0IGltYWdlID0gJyc7CgogICAgICAgICAgICAgIGlmKHNlbGVjdFZhci5pbWFnZXMudmFyaWF0aW9uLmxlbmd0aCA+IDApCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbGV0IHZhckltYWdlcyAgPSBzZWxlY3RWYXIuaW1hZ2VzLnZhcmlhdGlvblswXTsKCiAgICAgICAgICAgICAgICBpZih2YXJJbWFnZXMudXJsUHJldmlldyAhPT0gJycpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGltYWdlID0gdmFySW1hZ2VzLnVybFByZXZpZXcKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYodmFySW1hZ2VzLnVybFNlY29uZFByZXZpZXcgPT0gJycpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGltYWdlID0gdmFySW1hZ2VzLnVybFNlY29uZFByZXZpZXcKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYodmFySW1hZ2VzLnVybE1pZGRsZSA9PSAnJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgaW1hZ2UgPSB2YXJJbWFnZXMudXJsTWlkZGxlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGVsc2UgaWYoc2VsZWN0VmFyLmltYWdlcy5hbGwubGVuZ3RoID4gMCkKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBsZXQgYWxsSW1hZ2VzICA9IHNlbGVjdFZhci5pbWFnZXMuYWxsWzBdOwoKICAgICAgICAgICAgICAgIGlmKGFsbEltYWdlcy51cmxQcmV2aWV3ICE9PSAnJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgaW1hZ2UgPSBhbGxJbWFnZXMudXJsUHJldmlldwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihhbGxJbWFnZXMudXJsU2Vjb25kUHJldmlldyA9PSAnJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgaW1hZ2UgPSBhbGxJbWFnZXMudXJsU2Vjb25kUHJldmlldwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihhbGxJbWFnZXMudXJsTWlkZGxlID09ICcnKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBpbWFnZSA9IGFsbEltYWdlcy51cmxNaWRkbGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGxldCBuYW1lICA9ICcnOwoKICAgICAgICAgICAgICBpZihzZWxlY3RWYXIudGV4dHMubmFtZTEgIT09ICJOIC8gQSIpCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbmFtZSA9IHNlbGVjdFZhci50ZXh0cy5uYW1lMQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlIGlmKHNlbGVjdFZhci50ZXh0cy5uYW1lMiAhPT0gJ04gLyBBJykKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBuYW1lID0gc2VsZWN0VmFyLnRleHRzLm5hbWUyCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGVsc2UgaWYoc2VsZWN0VmFyLnRleHRzLm5hbWUzICE9PSAnTiAvIEEnKQogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWUgPSBzZWxlY3RWYXIudGV4dHMubmFtZTMKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgbGV0IG1hbnVmYWN0dXJlciA9ICcnOwoKICAgICAgICAgICAgICBpZihzZWxlY3RWYXIuZmlsdGVyLmhhc01hbnVmYWN0dXJlciAhPT0gZmFsc2UpCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbWFudWZhY3R1cmVyID0gc2VsZWN0VmFyLml0ZW0ubWFudWZhY3R1cmVyLm5hbWUKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX3NlbGYuc2VsZWN0ZWRWYXJpYXRpb24gPQogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczpzZWxlY3RWYXIuYXR0cmlidXRlcywKICAgICAgICAgICAgICAgICAgICBpdGVtSWQ6c2VsZWN0VmFyLnZhcmlhdGlvbi5pdGVtSWQsCiAgICAgICAgICAgICAgICAgICAgdmFySWQ6c2VsZWN0VmFyLnZhcmlhdGlvbi5pZCwKICAgICAgICAgICAgICAgICAgICBpdGVtTmFtZTpuYW1lLAogICAgICAgICAgICAgICAgICAgIG1hbnVmYWN0dXJlcjptYW51ZmFjdHVyZXIsCiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6aW1hZ2UsCiAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxJZDpzZWxlY3RWYXIudmFyaWF0aW9uLmV4dGVybmFsSWQsCiAgICAgICAgICAgICAgICAgICAgdmFyTnVtYmVyOnNlbGVjdFZhci52YXJpYXRpb24ubnVtYmVyLAogICAgICAgICAgICAgICAgICAgIGNsaWVudDpzZWxlY3RWYXIuaWRzLmNsaWVudHMKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhICYmIHJlc3BvbnNlLmRhdGEudmFycy5sZW5ndGggPiAwICkKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBmb3IobGV0IGkgPSAwIDsgaSA8IHJlc3BvbnNlLmRhdGEudmFycy5sZW5ndGggOyBpKyspCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50SXRlbURhdGEgPSByZXNwb25zZS5kYXRhLnZhcnNbaV0uZGF0YTsKCiAgICAgICAgICAgICAgICAgIGxldCBpbWFnZSA9ICcnOwoKICAgICAgICAgICAgICAgICAgaWYoY3VycmVudEl0ZW1EYXRhLmltYWdlcy52YXJpYXRpb24ubGVuZ3RoID4gMCkKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGxldCB2YXJJbWFnZXMgID0gY3VycmVudEl0ZW1EYXRhLmltYWdlcy52YXJpYXRpb25bMF07CgogICAgICAgICAgICAgICAgICAgIGlmKHZhckltYWdlcy51cmxQcmV2aWV3ICE9PSAnJykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICBpbWFnZSA9IHZhckltYWdlcy51cmxQcmV2aWV3CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodmFySW1hZ2VzLnVybFNlY29uZFByZXZpZXcgPT0gJycpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSB2YXJJbWFnZXMudXJsU2Vjb25kUHJldmlldwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHZhckltYWdlcy51cmxNaWRkbGUgPT0gJycpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSB2YXJJbWFnZXMudXJsTWlkZGxlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGVsc2UgaWYoY3VycmVudEl0ZW1EYXRhLmltYWdlcy5hbGwubGVuZ3RoID4gMCkKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGxJbWFnZXMgID0gY3VycmVudEl0ZW1EYXRhLmltYWdlcy5hbGxbMF07CgogICAgICAgICAgICAgICAgICAgIGlmKGFsbEltYWdlcy51cmxQcmV2aWV3ICE9PSAnJykKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICBpbWFnZSA9IGFsbEltYWdlcy51cmxQcmV2aWV3CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoYWxsSW1hZ2VzLnVybFNlY29uZFByZXZpZXcgPT0gJycpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSBhbGxJbWFnZXMudXJsU2Vjb25kUHJldmlldwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGFsbEltYWdlcy51cmxNaWRkbGUgPT0gJycpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSBhbGxJbWFnZXMudXJsTWlkZGxlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBsZXQgbmFtZSAgPSAnJzsKCiAgICAgICAgICAgICAgICAgIGlmKGN1cnJlbnRJdGVtRGF0YS50ZXh0cy5uYW1lMSAhPT0gIk4gLyBBIikKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG5hbWUgPSBjdXJyZW50SXRlbURhdGEudGV4dHMubmFtZTEKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBlbHNlIGlmKGN1cnJlbnRJdGVtRGF0YS50ZXh0cy5uYW1lMiAhPT0gJ04gLyBBJykKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG5hbWUgPSBjdXJyZW50SXRlbURhdGEudGV4dHMubmFtZTIKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBlbHNlIGlmKGN1cnJlbnRJdGVtRGF0YS50ZXh0cy5uYW1lMyAhPT0gJ04gLyBBJykKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG5hbWUgPSBjdXJyZW50SXRlbURhdGEudGV4dHMubmFtZTMKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgbGV0IG1hbnVmYWN0dXJlciA9ICcnOwoKICAgICAgICAgICAgICAgICAgaWYoY3VycmVudEl0ZW1EYXRhLmZpbHRlci5oYXNNYW51ZmFjdHVyZXIgIT09IGZhbHNlKQogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbWFudWZhY3R1cmVyID0gY3VycmVudEl0ZW1EYXRhLml0ZW0ubWFudWZhY3R1cmVyLm5hbWUKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgbGV0IG9iamVjdCA9IHsKICAgICAgICAgICAgICAgICAgICBpdGVtSWQ6Y3VycmVudEl0ZW1EYXRhLnZhcmlhdGlvbi5pdGVtSWQsCiAgICAgICAgICAgICAgICAgICAgdmFySWQ6cmVzcG9uc2UuZGF0YS52YXJzW2ldLmlkLAogICAgICAgICAgICAgICAgICAgIGl0ZW1OYW1lOm5hbWUsCiAgICAgICAgICAgICAgICAgICAgbWFudWZhY3R1cmVyOm1hbnVmYWN0dXJlciwKICAgICAgICAgICAgICAgICAgICBpbWFnZTppbWFnZSwKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjpyZXNwb25zZS5kYXRhLnZhcnNbaV0ucG9zaXRpb24sCiAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxJZDpjdXJyZW50SXRlbURhdGEudmFyaWF0aW9uLmV4dGVybmFsSWQsCiAgICAgICAgICAgICAgICAgICAgdmFyTnVtYmVyOmN1cnJlbnRJdGVtRGF0YS52YXJpYXRpb24ubnVtYmVyLAogICAgICAgICAgICAgICAgICAgIGNsaWVudDpjdXJyZW50SXRlbURhdGEuaWRzLmNsaWVudHMsCiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczpjdXJyZW50SXRlbURhdGEuYXR0cmlidXRlcwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIF9zZWxmLmN1cnJlbnRDcm9zc1NlbGxlci5wdXNoKG9iamVjdCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3NlbGYubG9hZGluZy5jcm9zc1NlbGxlciA9IGZhbHNlOwogICAgICAgICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICAgIF9zZWxmLmxvYWRpbmcuY3Jvc3NTZWxsZXIgPSBmYWxzZTsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpCiAgICAgICAgICAgIC8vIF9zZWxmLm15QWxlcnRzLmVycm9yID0gdHJ1ZTsKICAgICAgICAgICAgLy8gX3NlbGYubXlBbGVydHMuZXJyb3JNZXNzYWdlID0gZXJyb3IKICAgICAgICAgICAgLy8gX3NlbGYucmVzZXRFcm9ycigpOwogICAgICAgICAgfSkKCiAgICAgICAgfSwKICAgICAgICBidWlsZENhdGVnb3J5VHJlZURhdGEoZGF0YSkKICAgICAgICB7CiAgICAgICAgICBsZXQgY2F0ZWdvcmllcyA9IFtdOwoKICAgICAgICAgIGZvcihsZXQgaSA9IDAgOyBpIDwgZGF0YS5sZW5ndGggOyBpKyspCiAgICAgICAgICB7CiAgICAgICAgICAgIGxldCBjYXRlZ29yeSA9IHt9CiAgICAgICAgICAgIGlmKGRhdGFbaV0uaGFzT3duUHJvcGVydHkoImRldGFpbHMiKSAmJiBkYXRhW2ldLmRldGFpbHNbMF0uaGFzT3duUHJvcGVydHkoIm5hbWUiKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNhdGVnb3J5Lm5hbWUgPSBkYXRhW2ldLmRldGFpbHNbMF0ubmFtZQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKGRhdGFbaV0uaGFzT3duUHJvcGVydHkoImlkIikpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjYXRlZ29yeS5pZCA9ICBkYXRhW2ldLmlkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKGRhdGFbaV0uaGFzT3duUHJvcGVydHkoInBhcmVudENhdGVnb3J5SWQiKSkKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNhdGVnb3J5LnBhcmVudENhdGVnb3J5SWQgPSAgZGF0YVtpXS5wYXJlbnRDYXRlZ29yeUlkOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihkYXRhW2ldLmhhc093blByb3BlcnR5KCJjaGlsZENvdW50IikgJiYgZGF0YVtpXS5jaGlsZENvdW50ID4gMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgIGNhdGVnb3J5LmNoaWxkcmVuID0gdGhpcy5idWlsZENoaWxkVHJlZShkYXRhW2ldKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGVnb3JpZXMucHVzaChjYXRlZ29yeSkKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmNhdGVnb3J5VHJlZSA9IGNhdGVnb3JpZXMKICAgICAgICB9LAogICAgICAgIGJ1aWxkQ2hpbGRUcmVlKGRhdGEpCiAgICAgICAgewogICAgICAgICAgbGV0IGNoaWxkcmVuID0gW107CgogICAgICAgICAgZm9yKGxldCBpID0gMCA7IGkgPCBkYXRhLmNoaWxkQ291bnQgOyBpKyspCiAgICAgICAgICB7CiAgICAgICAgICAgIGlmKGRhdGEuY2hpbGRyZW5baV0pCiAgICAgICAgICAgIHsKCiAgICAgICAgICAgICAgbGV0IGNoaWxkID0gewogICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdCiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZihkYXRhLmNoaWxkcmVuW2ldLmhhc093blByb3BlcnR5KCJpZCIpKQogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGNoaWxkLmlkID0gIGRhdGEuY2hpbGRyZW5baV0uaWQ7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmKGRhdGEuY2hpbGRyZW5baV0uaGFzT3duUHJvcGVydHkoInBhcmVudENhdGVnb3J5SWQiKSkKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjaGlsZC5wYXJlbnRDYXRlZ29yeUlkID0gIGRhdGEuY2hpbGRyZW5baV0ucGFyZW50Q2F0ZWdvcnlJZDsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGlmKGRhdGEuY2hpbGRyZW5baV0uaGFzT3duUHJvcGVydHkoImRldGFpbHMiKSAmJiBkYXRhLmNoaWxkcmVuW2ldLmRldGFpbHMubGVuZ3RoID4gMCAmJiBkYXRhLmNoaWxkcmVuW2ldLmRldGFpbHNbMF0ubmFtZSkKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjaGlsZC5uYW1lID0gZGF0YS5jaGlsZHJlbltpXS5kZXRhaWxzWzBdLm5hbWUKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYoZGF0YS5jaGlsZHJlbltpXS5jaGlsZENvdW50ID4gMCkKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBjaGlsZC5jaGlsZHJlbiA9IHRoaXMuYnVpbGRDaGlsZFRyZWUoZGF0YS5jaGlsZHJlbltpXSkKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNoaWxkcmVuLnB1c2goY2hpbGQpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBjaGlsZHJlbjsKICAgICAgICB9LAogICAgICAgIGdldEluaXRpYWxEYXRhKCkKICAgICAgICB7CiAgICAgICAgICBsZXQgX3NlbGYgPSB0aGlzOwoKICAgICAgICAgIF9zZWxmLiRodHRwLmdldCggcHJvY2Vzcy5lbnYuVlVFX0FQUF9HRVRfREFUQSsnMCcrcHJvY2Vzcy5lbnYuVlVFX0FQUF9QTFVHSU5fU0VUX1BSRVZJRVcpLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgIGlmKHJlc3BvbnNlKQogICAgICAgICAgICB7CgogICAgICAgICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YQogICAgICAgICAgICAgIF9zZWxmLmJ1aWxkQ2F0ZWdvcnlUcmVlRGF0YShkYXRhLmNhdGVnb3J5VHJlZSkKCiAgICAgICAgICAgICAgX3NlbGYudGFncyA9IFtdCiAgICAgICAgICAgICAgZm9yKGxldCBpID0gMCAgOyBpIDwgZGF0YS50YWdzLmxlbmd0aCA7IGkrKykKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBkYXRhLnRhZ3NbaV0udGV4dCAgPSBkYXRhLnRhZ3NbaV0udGFnTmFtZQogICAgICAgICAgICAgICAgZGF0YS50YWdzW2ldLnZhbHVlICA9IGRhdGEudGFnc1tpXS5pZAoKICAgICAgICAgICAgICAgIF9zZWxmLnRhZ3MucHVzaChkYXRhLnRhZ3NbaV0pCiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3IobGV0IGkgPSAwIDsgaSA8IGRhdGEubWFudWZhY3R1cmVyLmVudHJpZXMubGVuZ3RoIDsgaSsrKQogICAgICAgICAgICAgIHsKCiAgICAgICAgICAgICAgICBfc2VsZi5tYW51ZmFjdHVyZXJNYXBbZGF0YS5tYW51ZmFjdHVyZXIuZW50cmllc1tpXS5uYW1lXSA9IGRhdGEubWFudWZhY3R1cmVyLmVudHJpZXNbaV0uaWQKICAgICAgICAgICAgICAgIF9zZWxmLnNlbGVjdEl0ZW1zLm1hbnVmYWN0dXJlci5wdXNoKGRhdGEubWFudWZhY3R1cmVyLmVudHJpZXNbaV0ubmFtZSkKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGZvcihsZXQgaSA9IDAgOyBpIDwgZGF0YS53ZWJTdG9yZUNvbmZpZy5sZW5ndGggOyBpKyspCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgX3NlbGYubWFuZGFudE1hcFtkYXRhLndlYlN0b3JlQ29uZmlnW2ldLm5hbWVdID0gZGF0YS53ZWJTdG9yZUNvbmZpZ1tpXS5zdG9yZUlkZW50aWZpZXIKICAgICAgICAgICAgICAgIF9zZWxmLnNlbGVjdEl0ZW1zLm1hbmRhbnQucHVzaChkYXRhLndlYlN0b3JlQ29uZmlnW2ldLm5hbWUpCiAgICAgICAgICAgICAgfQoKCgogICAgICAgICAgICAgIF9zZWxmLnNlYXJjaEZpbHRlcklucHV0U2VhcmNoID0gIFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgImtleSI6Im1hbnVmYWN0dXJlciIsCiAgICAgICAgICAgICAgICAgICJuYW1lIjogJ0hlcnN0ZWxsZXI6JywKICAgICAgICAgICAgICAgICAgIm9wZXJhdG9yIjogIj0iLAogICAgICAgICAgICAgICAgICAidHlwZSI6InNlbGVjdCIsCiAgICAgICAgICAgICAgICAgICJpdGVtcyI6X3NlbGYuc2VsZWN0SXRlbXMubWFudWZhY3R1cmVyLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgImtleSI6ImNsaWVudCIsCiAgICAgICAgICAgICAgICAgICJuYW1lIjogJ01hbmRhbnQ6JywKICAgICAgICAgICAgICAgICAgIm9wZXJhdG9yIjogIkxJS0UiLAogICAgICAgICAgICAgICAgICAidHlwZSI6InNlbGVjdCIsCiAgICAgICAgICAgICAgICAgICJpdGVtcyI6X3NlbGYuc2VsZWN0SXRlbXMubWFuZGFudCwKICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgICAgICAgLy8gX3NlbGYubXlBbGVydHMuZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAvLyBfc2VsZi5teUFsZXJ0cy5lcnJvck1lc3NhZ2UgPSBlcnJvcgogICAgICAgICAgICAvLyBfc2VsZi5yZXNldEVyb3JyKCk7CiAgICAgICAgICB9KQoKICAgICAgICB9LAogICAgICAgIHJlY2FsY1Bvc3RpdGlvbnMoaXRlbSxpbmRleCA9IC0xKQogICAgICAgIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdwb3MnLGluZGV4KQogICAgICAgICAgaWYoaW5kZXggPiAtMSkgewogICAgICAgICAgICBsZXQgX3NlbGYgPSB0aGlzOwoKICAgICAgICAgICAgbGV0IGl0ZW1JbmRleCA9IF9zZWxmLmN1cnJlbnRDcm9zc1NlbGxlci5pbmRleE9mKGl0ZW0pOwoKICAgICAgICAgICAgaWYgKGluZGV4ID09IDApIHsKICAgICAgICAgICAgICBfc2VsZi5jdXJyZW50Q3Jvc3NTZWxsZXIuc3BsaWNlKGl0ZW1JbmRleCwgMSk7CiAgICAgICAgICAgICAgX3NlbGYuY3VycmVudENyb3NzU2VsbGVyLnVuc2hpZnQoaXRlbSkKICAgICAgICAgICAgfSBlbHNlIGlmIChpbmRleCA+IF9zZWxmLmN1cnJlbnRDcm9zc1NlbGxlci5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgX3NlbGYuY3VycmVudENyb3NzU2VsbGVyLnNwbGljZShpdGVtSW5kZXgsIDEpCiAgICAgICAgICAgICAgX3NlbGYuY3VycmVudENyb3NzU2VsbGVyLnB1c2goaXRlbSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX3NlbGYuY3VycmVudENyb3NzU2VsbGVyLnNwbGljZShpdGVtSW5kZXgsIDEpCiAgICAgICAgICAgICAgX3NlbGYuY3VycmVudENyb3NzU2VsbGVyLnNwbGljZShpbmRleCwgMCwgaXRlbSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IGRhdGEgPQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAidXBkYXRlT24iOiBfc2VsZi5zZWxlY3RlZFZhcmlhdGlvbi52YXJJZCwKICAgICAgICAgICAgICAgICAgInRvVXBkYXRlIjogW10KICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IF9zZWxmLmN1cnJlbnRDcm9zc1NlbGxlci5sZW5ndGg7IGkrKykKICAgICAgICAgICAgewogICAgICAgICAgICAgIF9zZWxmLmN1cnJlbnRDcm9zc1NlbGxlcltpXS5wb3NpdGlvbiA9IGkgKyAxOwoKICAgICAgICAgICAgICBkYXRhLnRvVXBkYXRlLnB1c2gKICAgICAgICAgICAgICAoCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAidmFySWQiOiBfc2VsZi5jdXJyZW50Q3Jvc3NTZWxsZXJbaV0udmFySWQsCiAgICAgICAgICAgICAgICAgICAgInBvc2l0aW9uIjogX3NlbGYuY3VycmVudENyb3NzU2VsbGVyW2ldLnBvc2l0aW9uLAogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgKQogICAgICAgICAgICB9CgogICAgICAgICAgICBfc2VsZi5jdXJyZW50Q3Jvc3NTZWxsZXIuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgIGxldCBwb3NpdGlvbkEgPSBuZXcgRGF0ZShhLnBvc2l0aW9uKQogICAgICAgICAgICAgIGxldCBwb3NpdGlvbkIgPSBuZXcgRGF0ZShiLnBvc2l0aW9uKTsKICAgICAgICAgICAgICBpZiAocG9zaXRpb25BIDwgcG9zaXRpb25CKSByZXR1cm4gLTE7CiAgICAgICAgICAgICAgaWYgKHBvc2l0aW9uQSA+IHBvc2l0aW9uQikgcmV0dXJuIDE7CiAgICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICAgIH0pOwoKCiAgICAgICAgICAgIF9zZWxmLiRodHRwLnBvc3QocHJvY2Vzcy5lbnYuVlVFX0FQUF9VUERBVEVfUE9TSVRJT04gKyBwcm9jZXNzLmVudi5WVUVfQVBQX1BMVUdJTl9TRVRfUFJFVklFVywgZGF0YSkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICBpZiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIF9zZWxmLmFsZXJ0cy5wb3NpdGlvbi50eXBlID0gJ3N1Y2Nlc3MnOwogICAgICAgICAgICAgICAgX3NlbGYuYWxlcnRzLnBvc2l0aW9uLm1lc3NhZ2UgPSAiRGllIFBvc2l0aW9ucyDDhG5kZXJ1bmcgd2FyIGVyZm9sZ3JlaWNoIgogICAgICAgICAgICAgICAgX3NlbGYuYWxlcnRzLnBvc2l0aW9uLmlzQWN0aXZlID0gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgICAgIF9zZWxmLmFsZXJ0cy5wb3NpdGlvbi50eXBlID0gJ2Vycm9yJzsKICAgICAgICAgICAgICBfc2VsZi5hbGVydHMucG9zaXRpb24ubWVzc2FnZSA9ICJEaWUgUG9zaXRpb25zIMOEbmRlcnVuZyB3YXIgTklDSFQgZXJmb2xncmVpY2giCiAgICAgICAgICAgICAgX3NlbGYuYWxlcnRzLnBvc2l0aW9uLmlzQWN0aXZlID0gdHJ1ZTsKCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBzZWFyY2goZXZlbnQgPSB7fSkKICAgICAgICB7CiAgICAgICAgICBsZXQgX3NlbGYgPSB0aGlzOwoKICAgICAgICAgIGlmKGV2ZW50ICE9PSB7fSkKICAgICAgICAgIHsKICAgICAgICAgICAgX3NlbGYuc2VhcmNoT3B0aW9ucy5wYWdlID0gZXZlbnQucGFnZTsKICAgICAgICAgICAgX3NlbGYuc2VhcmNoT3B0aW9ucy5pdGVtc1BlclBhZ2UgPSBldmVudC5pdGVtc1BlclBhZ2U7CiAgICAgICAgICB9CgogICAgICAgICAgX3NlbGYubG9hZGluZy5zZWFyY2ggPSB0cnVlOwoKICAgICAgICAgIGxldCBkYXRhID0gewogICAgICAgICAgICB3aXRoOidhZGRpdGlvbmFsU2t1cyxhdHRyaWJ1dGVWYWx1ZXMuYXR0cmlidXRlLGF0dHJpYnV0ZVZhbHVlcy5hdHRyaWJ1dGVWYWx1ZSxiYXJjb2Rlcy5iYXJjb2RlLGJhc2UuaXRlbSxiYXNlLml0ZW1TZXJpYWxOdW1iZXIsYmFzZS5mZWVkYmFjayxiYXNlLmNoYXJhY3RlcmlzdGljcyxiYXNlLmNyb3NzU2VsbGluZyxiYXNlLnRleHRzLGJhc2UuYXZhaWxhYmlsaXR5LGJhc2UuaW1hZ2VzLGJhc2Uuc3RvY2ssYmFzZS5zdG9ja1N0b3JhZ2VMb2NhdGlvbnMsYnVuZGxlQ29tcG9uZW50cyxjYXRlZ29yaWVzLmNhdGVnb3J5LGNhdGVnb3JpZXMuY2F0ZWdvcnlCcmFuY2gsY2xpZW50cyxkZWZhdWx0Q2F0ZWdvcmllcy5jYXRlZ29yeSxpbWFnZXMuaW1hZ2UsbWFya2V0cyxtYXJrZXRJZGVudE51bWJlcnMsc2FsZXNQcmljZXMuc2FsZXNQcmljZSxza3VzLHN1cHBsaWVyLnN1cHBsaWVyLHRpbWVzdGFtcHMsd2FyZWhvdXNlcy53YXJlaG91c2UsdW5pdC51bml0LHRhZ3MudGFnLGJhc2Uuc2hpcHBpbmdQcm9maWxlcyxjb21tZW50cyxpbmhlcml0YW5jZScsCiAgICAgICAgICAgIHBhZ2U6X3NlbGYuc2VhcmNoT3B0aW9ucy5wYWdlLAogICAgICAgICAgICBpdGVtc1BlclBhZ2U6X3NlbGYuc2VhcmNoT3B0aW9ucy5pdGVtc1BlclBhZ2UKICAgICAgICAgIH0KCgogICAgICAgICAgaWYoX3NlbGYuc2VhcmNoRmlsdGVyLmNhdGVnb3JpZXMubGVuZ3RoID4gMCAmJiBfc2VsZi51c2VDYXRlZ29yaWVzID09IHRydWUpCiAgICAgICAgICB7CiAgICAgICAgICAgIGxldCBjYXRJZHMgPSBbXTsKICAgICAgICAgICAgZm9yKGxldCBpID0gMCA7IGkgPCBfc2VsZi5zZWFyY2hGaWx0ZXIuY2F0ZWdvcmllcy5sZW5ndGggOyBpKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjYXRJZHMucHVzaChfc2VsZi5zZWFyY2hGaWx0ZXIuY2F0ZWdvcmllc1tpXS5pZCkKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRJZHMgPSBjYXRJZHMudG9TdHJpbmcoKQoKICAgICAgICAgICAgZGF0YS5jYXRlZ29yeUlkcyA9ICdpbjonKyBjYXRJZHMKICAgICAgICAgIH0KICAgICAgICAgIGlmKF9zZWxmLnNlYXJjaEZpbHRlci52YXJJZCA+IDApCiAgICAgICAgICB7CiAgICAgICAgICAgIGRhdGEuaWRzID0gJ2luOicrX3NlbGYuc2VhcmNoRmlsdGVyLnZhcklkCiAgICAgICAgICB9CiAgICAgICAgICBpZihfc2VsZi5zZWFyY2hGaWx0ZXIudmFyTnVtYmVyID4gMCkKICAgICAgICAgIHsKICAgICAgICAgICAgZGF0YS5udW1iZXIgPSAnbGlrZTonK19zZWxmLnNlYXJjaEZpbHRlci52YXJOdW1iZXIKICAgICAgICAgIH0KICAgICAgICAgIGlmKF9zZWxmLnNlYXJjaEZpbHRlci5pdGVtSWQgPiAwKQogICAgICAgICAgewogICAgICAgICAgICBkYXRhLml0ZW1JZHMgPSAnaW46Jytfc2VsZi5zZWFyY2hGaWx0ZXIuaXRlbUlkCiAgICAgICAgICB9CiAgICAgICAgICBpZihfc2VsZi5zZWFyY2hGaWx0ZXIubWFuZGFudC5sZW5ndGggPjApCiAgICAgICAgICB7CiAgICAgICAgICAgIGlmKF9zZWxmLnNlYXJjaEZpbHRlci5tYW5kYW50Lmxlbmd0aCA9PSAxKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgZGF0YS5jbGllbnRJZHMgPSAnaW46Jytfc2VsZi5tYW5kYW50TWFwW19zZWxmLnNlYXJjaEZpbHRlci5tYW5kYW50XQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgZGF0YS5jbGllbnRJZHMgPSAnaW46JwogICAgICAgICAgICAgIGZvcihsZXQgaSA9IDAgOyBpIDwgX3NlbGYuc2VhcmNoRmlsdGVyLm1hbmRhbnQubGVuZ3RoIDsgaSsrKQogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmKGkrMSA9PSBfc2VsZi5zZWFyY2hGaWx0ZXIubWFuZGFudC5sZW5ndGggKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBkYXRhLmNsaWVudElkcyA9ICBkYXRhLmNsaWVudElkcyArIF9zZWxmLm1hbmRhbnRNYXBbX3NlbGYuc2VhcmNoRmlsdGVyLm1hbmRhbnRbaV1dCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgICBkYXRhLmNsaWVudElkcyA9ICBkYXRhLmNsaWVudElkcyArIF9zZWxmLm1hbmRhbnRNYXBbX3NlbGYuc2VhcmNoRmlsdGVyLm1hbmRhbnRbaV1dICsgJywnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZihfc2VsZi5zZWxlY3RlZFRhZ3MubGVuZ3RoID4wKQogICAgICAgICAgewogICAgICAgICAgICBkYXRhLnRhZ0lkcyA9ICdpbjonK19zZWxmLnNlbGVjdGVkVGFncy50b1N0cmluZygpCiAgICAgICAgICB9CiAgICAgICAgICBpZihfc2VsZi5zZWFyY2hGaWx0ZXIuaXRlbURhdGEubGVuZ3RoID4gMCkKICAgICAgICAgIHsKICAgICAgICAgICAgZGF0YS5xdWVyeSA9IF9zZWxmLnNlYXJjaEZpbHRlci5pdGVtRGF0YQogICAgICAgICAgfQogICAgICAgICAgaWYoX3NlbGYuc2VhcmNoRmlsdGVyLm1hbnVmYWN0dXJlci5sZW5ndGggPiAwKQogICAgICAgICAgewogICAgICAgICAgICBkYXRhLmFueU1hbnVmYWN0dXJlcklkID0gW10KICAgICAgICAgICAgZm9yKGxldCBpID0gMCA7IGkgPCBfc2VsZi5zZWFyY2hGaWx0ZXIubWFudWZhY3R1cmVyLmxlbmd0aCA7IGkrKykKICAgICAgICAgICAgewogICAgICAgICAgICAgIGRhdGEuYW55TWFudWZhY3R1cmVySWQucHVzaChfc2VsZi5tYW51ZmFjdHVyZXJNYXBbX3NlbGYuc2VhcmNoRmlsdGVyLm1hbnVmYWN0dXJlcltpXV0pCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmKF9zZWxmLnNlYXJjaEZpbHRlci5pc0FjdGl2ZSAhPT0gJ0FMTEUnKQogICAgICAgICAgewogICAgICAgICAgICBpZihfc2VsZi5zZWFyY2hGaWx0ZXIuaXNBY3RpdmUgPT0gJ0pBJykKICAgICAgICAgICAgewogICAgICAgICAgICAgIGRhdGEuaXNBY3RpdmUgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYoIF9zZWxmLnNlYXJjaEZpbHRlci5pc0FjdGl2ZSA9PSAnTkVJTicpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBkYXRhLmlzQWN0aXZlID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGlmKF9zZWxmLnNlYXJjaEZpbHRlci5tYXJrMiA9PSAiT2huZSIpCiAgICAgICAgICB7CiAgICAgICAgICAgIGRhdGEuZmxhZzIgPSAnaW46MCcKICAgICAgICAgIH0KICAgICAgICAgIGVsc2UgaWYoX3NlbGYuc2VhcmNoRmlsdGVyLm1hcmsyID4gLTEpCiAgICAgICAgICB7CiAgICAgICAgICAgIGRhdGEuZmxhZzIgPSAnaW46Jytfc2VsZi5zZWFyY2hGaWx0ZXIubWFyazI7CiAgICAgICAgICB9CiAgICAgICAgICBpZihfc2VsZi5zZWFyY2hGaWx0ZXIubWFyazEgPT0gIk9obmUiKQogICAgICAgICAgewogICAgICAgICAgICBkYXRhLmZsYWcxID0gJ2luOjAnCiAgICAgICAgICB9CiAgICAgICAgICBlbHNlIGlmKF9zZWxmLnNlYXJjaEZpbHRlci5tYXJrMSA+IC0xKQogICAgICAgICAgewogICAgICAgICAgICBkYXRhLmZsYWcxID0gJ2luOicrX3NlbGYuc2VhcmNoRmlsdGVyLm1hcmsxOwogICAgICAgICAgfQogICAgICAgICAgX3NlbGYuJGh0dHAuZ2V0KHByb2Nlc3MuZW52LlZVRV9BUFBfR0VUX1ZBUklBVElPTlMgLCB7cGFyYW1zIDpkYXRhfSkudGhlbigocmVzcG9uc2UpID0+CiAgICAgICAgICB7CgogICAgICAgICAgICBsZXQgcmVwbGFjZVRhYmxlID0gW10KCiAgICAgICAgICAgIGlmKHJlc3BvbnNlICYmIHJlc3BvbnNlLmRhdGEgJiYgcmVzcG9uc2UuZGF0YVsiZW50cmllcyJdLmxlbmd0aCA+IDApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgICAgIF9zZWxmLnNlYXJjaFJlc3VsdHNUb3RhbCA9IGRhdGEudG90YWxzQ291bnQ7CgogICAgICAgICAgICAgIGZvcihsZXQgaSA9IDAgOyBpIDwgZGF0YVsiZW50cmllcyJdLmxlbmd0aCA7IGkrKykKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBsZXQgaW1hZ2UgPSAnJwogICAgICAgICAgICAgICAgaWYoZGF0YVsiZW50cmllcyJdW2ldLmJhc2UuaW1hZ2VzLmxlbmd0aCA+IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIGltYWdlID0gZGF0YVsiZW50cmllcyJdW2ldLmJhc2UuaW1hZ2VzWzBdLnVybFByZXZpZXcKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBsZXQgbmFtZSA9ICcnOwogICAgICAgICAgICAgICAgaWYoZGF0YVsiZW50cmllcyJdW2ldLmJhc2UudGV4dHMubGVuZ3RoID4gMCkKICAgICAgICAgICAgICAgIHsKCiAgICAgICAgICAgICAgICAgIG5hbWUgPSBkYXRhWyJlbnRyaWVzIl1baV0uYmFzZS50ZXh0c1swXS5uYW1lCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbGV0IG1hbnVmYWN0dXJlciA9ICcnCgogICAgICAgICAgICAgICAgZm9yIChsZXQgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKF9zZWxmLm1hbnVmYWN0dXJlck1hcCkpIHsKICAgICAgICAgICAgICAgICAgaWYodmFsdWUgPT0gZGF0YVsiZW50cmllcyJdW2ldLmJhc2UuaXRlbS5tYW51ZmFjdHVyZXJJZCkKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG1hbnVmYWN0dXJlciA9IGtleTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxldCBjbGllbnRzID0gW10KCiAgICAgICAgICAgICAgICBmb3IgKGxldCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoX3NlbGYubWFuZGFudE1hcCkpIHsKICAgICAgICAgICAgICAgICAgZm9yKCBsZXQgYSA9IDAgOyBhIDwgZGF0YVsiZW50cmllcyJdW2ldLmNsaWVudHMubGVuZ3RoIDsgYSsrKQogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYodmFsdWUgPT0gZGF0YVsiZW50cmllcyJdW2ldLmNsaWVudHNbYV0pCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgY2xpZW50cy5wdXNoKHZhbHVlKSA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbGV0IG9iamVjdCA9IHsKICAgICAgICAgICAgICAgICAgaXRlbUlkOmRhdGFbImVudHJpZXMiXVtpXS5iYXNlLml0ZW1JZCwKICAgICAgICAgICAgICAgICAgdmFySWQ6ZGF0YVsiZW50cmllcyJdW2ldLmlkLAogICAgICAgICAgICAgICAgICBtYW51ZmFjdHVyZXI6bWFudWZhY3R1cmVyLAogICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOmRhdGFbImVudHJpZXMiXVtpXS5hdHRyaWJ1dGVWYWx1ZXMsCiAgICAgICAgICAgICAgICAgIGltYWdlOmltYWdlLAogICAgICAgICAgICAgICAgICBpdGVtTmFtZTpuYW1lLAogICAgICAgICAgICAgICAgICBleHRlcm5hbElkOmRhdGFbImVudHJpZXMiXVtpXS5iYXNlLmV4dGVybmFsSWQsCiAgICAgICAgICAgICAgICAgIGNsaWVudDpjbGllbnRzLAogICAgICAgICAgICAgICAgICB0YWdzOmRhdGFbImVudHJpZXMiXVtpXS50YWdzLAogICAgICAgICAgICAgICAgICB2YXJOdW1iZXI6ZGF0YVsiZW50cmllcyJdW2ldLmJhc2UubnVtYmVyLAogICAgICAgICAgICAgICAgICBpc1NlbGVjdGFibGU6KCFfc2VsZi5hbHJlYWR5Q3Jvc3NTZWxsZXIoZGF0YVsiZW50cmllcyJdW2ldLmlkKSAmJiBkYXRhWyJlbnRyaWVzIl1baV0uaWQgIT09IF9zZWxmLnNlbGVjdGVkVmFyaWF0aW9uLnZhcklkKSB8fCAoX3NlbGYuc2VhcmNoaW5nVmFyaWFudFRvU2VsZWN0ID09IHRydWUgJiYgZGF0YVsiZW50cmllcyJdW2ldLmlkICE9PSBfc2VsZi5zZWxlY3RlZFZhcmlhdGlvbi52YXJJZCkKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXBsYWNlVGFibGUucHVzaChvYmplY3QpCgogICAgICAgICAgICAgICAgX3NlbGYubG9hZGluZy5zZWFyY2ggPSBmYWxzZTsKICAgICAgICAgICAgICAgIF9zZWxmLnNlYXJjaFJlc3VsdHMgPSByZXBsYWNlVGFibGUKICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgX3NlbGYubG9hZGluZy5zZWFyY2ggPSBmYWxzZTsKICAgICAgICAgICAgICBfc2VsZi5zZWFyY2hSZXN1bHRzID0gcmVwbGFjZVRhYmxlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKCiAgICAgICAgICAgIF9zZWxmLmxvYWRpbmcuc2VhcmNoID0gZmFsc2U7CiAgICAgICAgICAgIF9zZWxmLnNlYXJjaFJlc3VsdHMgPSBbXTsKCiAgICAgICAgICAgIF9zZWxmLmFsZXJ0cy5zZWFyY2guaXNBY3RpdmUgPSB0cnVlOwogICAgICAgICAgICBfc2VsZi5hbGVydHMuc2VhcmNoLm1lc3NhZ2UgPSAiU3VjaGUgZmVobGdlc2NobGFnZW4iCiAgICAgICAgICAgIF9zZWxmLmFsZXJ0cy5zZWFyY2gudHlwZSA9ICJlcnJvciIKICAgICAgICAgICAgLy8gX3NlbGYubXlBbGVydHMuZXJyb3IgPSB0cnVlOwogICAgICAgICAgICAvLyBfc2VsZi5teUFsZXJ0cy5lcnJvck1lc3NhZ2UgPSBlcnJvcgogICAgICAgICAgICAvLyBfc2VsZi5yZXNldEVyb3JyKCk7CiAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgdXBkYXRlRGF0YShldmVudCkKICAgICAgICB7CiAgICAgICAgICBsZXQgX3NlbGYgICA9IHRoaXM7CgogICAgICAgICAgX3NlbGYub3B0aW9ucy5pdGVtc1BlclBhZ2UgID0gZXZlbnQuaXRlbXNQZXJQYWdlOwogICAgICAgICAgX3NlbGYub3B0aW9ucy5wYWdlICAgICAgICAgID0gZXZlbnQucGFnZTsKICAgICAgICAgIF9zZWxmLm9wdGlvbnMub3JkZXJCeSAgICAgICA9IGV2ZW50LnNvcnRCeVswXTsKICAgICAgICAgIF9zZWxmLm9wdGlvbnMub3JkZXJEZXNjICAgICA9IGV2ZW50LnNvcnREZXNjWzBdCgogICAgICAgICAgdGhpcy5keW5hbWljR2V0KCdjcm9zc1NlbGxlcicsdGhpcy5vcHRpb25zLml0ZW1zUGVyUGFnZSx0aGlzLm9wdGlvbnMucGFnZSx0aGlzLm9wdGlvbnMub3JkZXJCeSx0aGlzLm9wdGlvbnMub3JkZXJEZXNjLHRoaXMub3B0aW9ucy5maWx0ZXIpCiAgICAgICAgfSwKICAgICAgICBzZWFyY2hTZWxlY3RVcGRhdGUoZXZlbnQpCiAgICAgICAgewogICAgICAgICAgbGV0IG5lZWRBcnJheSA9IFtdOwogICAgICAgICAgbmVlZEFycmF5LnB1c2goZXZlbnQpOwogICAgICAgICAgdGhpcy5maWx0ZXJVcGRhdGVuKG5lZWRBcnJheSk7CiAgICAgICAgfSwKICAgICAgICBmaWx0ZXJVcGRhdGVuKGRhdGEpCiAgICAgICAgewogICAgICAgICAgbGV0IGZpbHRlciA9IFtdOwogICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKysgKQogICAgICAgICAgewoKICAgICAgICAgICAgaWYoZGF0YVtpXS52YWx1ZSAhPSAiIiAmJiBkYXRhW2ldLnZhbHVlICE9IG51bGwgKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbGV0IG9wdGlvbiA9CiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAid2hlcmUiOmRhdGFbaV0ua2V5CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZihkYXRhW2ldLnR5cGUgPT0gJ2RhdGUnKQogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG9wdGlvbi52YWx1ZSA9IG5ldyBEYXRlKGRhdGFbaV0udmFsdWUpLmdldFRpbWUoKS8xMDAwCiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBvcHRpb24udmFsdWUgPSBkYXRhW2ldLnZhbHVlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZihkYXRhW2ldLnR5cGUgPT0gInN3aXRjaCIpCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgb3B0aW9uLnZhbHVlID0gKGRhdGFbaV0udmFsdWUgPT0gdHJ1ZSkgPyAxIDogMDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGFbaV0sICdvcGVyYXRvcicpKQogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG9wdGlvbi5vcGVyYXRvciA9IGRhdGFbaV0ub3BlcmF0b3IKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYoZGF0YVtpXS5rZXkgPT0gImNsaWVudCIpCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZm9yIChsZXQgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMubWFuZGFudE1hcCkpIHsKICAgICAgICAgICAgICAgICAgaWYoZGF0YVtpXS52YWx1ZSA9PSBrZXkpCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBvcHRpb24udmFsdWUgPSAnJScrdmFsdWUrJyUnOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGZpbHRlci5wdXNoKG9wdGlvbikKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5vcHRpb25zLmZpbHRlciA9IGZpbHRlcjsKCiAgICAgICAgICB0aGlzLmR5bmFtaWNHZXQoJ2Nyb3NzU2VsbGVyJyx0aGlzLm9wdGlvbnMuaXRlbXNQZXJQYWdlLHRoaXMub3B0aW9ucy5wYWdlLHRoaXMub3B0aW9ucy5vcmRlckJ5LHRoaXMub3B0aW9ucy5vcmRlckRlc2MsdGhpcy5vcHRpb25zLmZpbHRlcikKICAgICAgICB9LAogICAgICAgIGR5bmFtaWNHZXQoZGIgPSAnY3Jvc3NTZWxsZXInLGl0ZW1zUGVyUGFnZSA9IDIwLHBhZ2UgPSAxLG9yZGVyQnkgPSAnaWQnLG9yZGVyID0gJ2Rlc2MnLGZpbHRlciA9IFtdKSB7CiAgICAgICAgICBsZXQgX3NlbGYgPSB0aGlzOwoKICAgICAgICAgIGxldCBsaW5rID0gcHJvY2Vzcy5lbnYuVlVFX0FQUF9EWU5BTUlDX0dFVCArIHByb2Nlc3MuZW52LlZVRV9BUFBfUExVR0lOX1NFVF9QUkVWSUVXCgogICAgICAgICAgbGV0IG9yZGVyRGVzYyA9ICdkZXNjJzsKCiAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgImRiIjpkYiwKICAgICAgICAgICAgIml0ZW1zUGVyUGFnZSI6aXRlbXNQZXJQYWdlLAogICAgICAgICAgICAicGFnZSI6cGFnZSwKICAgICAgICAgICAgIm9yZGVyQnkiOm9yZGVyQnksCiAgICAgICAgICAgICJvcmRlckRlc2MiOm9yZGVyRGVzYywKICAgICAgICAgICAgImZpbHRlciI6ZmlsdGVyLAogICAgICAgICAgICAiZ2V0SXRlbURhdGEiOnRydWUKICAgICAgICAgIH0KCiAgICAgICAgICBfc2VsZi5sb2FkaW5nLmRhc2hib2FyZFNlYXJjaCA9IHRydWU7CiAgICAgICAgICBfc2VsZi5kYXNoYm9hcmRDcm9zc1NlbGxlciA9IFtdOwoKICAgICAgICAgIF9zZWxmLiRodHRwLnBvc3QobGluayxkYXRhKS50aGVuKChyZXNwb25zZSkgPT4KICAgICAgICAgIHsKICAgICAgICAgICAgbGV0IHJlcGxhY2VUYWJsZSA9IFtdOwoKICAgICAgICAgICAgaWYocmVzcG9uc2UuZGF0YSAmJiByZXNwb25zZS5kYXRhLmR5bmFtaWNFbnRyaWVzICYmIHJlc3BvbnNlLmRhdGEuZHluYW1pY0VudHJpZXMuZW50cmllcy5sZW5ndGggPiAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgX3NlbGYudG90YWxDcm9zc1NlbGxlciA9IHJlc3BvbnNlLmRhdGEuZHluYW1pY0VudHJpZXMuaXRlbXNUb3RhbDsKCiAgICAgICAgICAgICAgZm9yKGxldCBpID0gMCA7IGkgPCByZXNwb25zZS5kYXRhLmR5bmFtaWNFbnRyaWVzLmVudHJpZXMubGVuZ3RoIDsgaSsrKQogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGxldCBjdXJyZW50SXRlbURhdGEgPSByZXNwb25zZS5kYXRhLmR5bmFtaWNFbnRyaWVzLmVudHJpZXNbaV0uZGF0YTsKCiAgICAgICAgICAgICAgICBsZXQgaW1hZ2UgPSAnJzsKCiAgICAgICAgICAgICAgICBpZihjdXJyZW50SXRlbURhdGEuaW1hZ2VzLnZhcmlhdGlvbi5sZW5ndGggPiAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBsZXQgdmFySW1hZ2VzICA9IGN1cnJlbnRJdGVtRGF0YS5pbWFnZXMudmFyaWF0aW9uWzBdOwoKICAgICAgICAgICAgICAgICAgaWYodmFySW1hZ2VzLnVybFByZXZpZXcgIT09ICcnKQogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSB2YXJJbWFnZXMudXJsUHJldmlldwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGVsc2UgaWYodmFySW1hZ2VzLnVybFNlY29uZFByZXZpZXcgPT0gJycpCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpbWFnZSA9IHZhckltYWdlcy51cmxTZWNvbmRQcmV2aWV3CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgZWxzZSBpZih2YXJJbWFnZXMudXJsTWlkZGxlID09ICcnKQogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSB2YXJJbWFnZXMudXJsTWlkZGxlCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYoY3VycmVudEl0ZW1EYXRhLmltYWdlcy5hbGwubGVuZ3RoID4gMCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgbGV0IGFsbEltYWdlcyAgPSBjdXJyZW50SXRlbURhdGEuaW1hZ2VzLmFsbFswXTsKCiAgICAgICAgICAgICAgICAgIGlmKGFsbEltYWdlcy51cmxQcmV2aWV3ICE9PSAnJykKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGltYWdlID0gYWxsSW1hZ2VzLnVybFByZXZpZXcKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBlbHNlIGlmKGFsbEltYWdlcy51cmxTZWNvbmRQcmV2aWV3ID09ICcnKQogICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSBhbGxJbWFnZXMudXJsU2Vjb25kUHJldmlldwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGVsc2UgaWYoYWxsSW1hZ2VzLnVybE1pZGRsZSA9PSAnJykKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGltYWdlID0gYWxsSW1hZ2VzLnVybE1pZGRsZQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbGV0IG5hbWUgID0gJyc7CgogICAgICAgICAgICAgICAgaWYoY3VycmVudEl0ZW1EYXRhLnRleHRzLm5hbWUxICE9PSAiTiAvIEEiKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBuYW1lID0gY3VycmVudEl0ZW1EYXRhLnRleHRzLm5hbWUxCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmKGN1cnJlbnRJdGVtRGF0YS50ZXh0cy5uYW1lMiAhPT0gJ04gLyBBJykKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgbmFtZSA9IGN1cnJlbnRJdGVtRGF0YS50ZXh0cy5uYW1lMgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZihjdXJyZW50SXRlbURhdGEudGV4dHMubmFtZTMgIT09ICdOIC8gQScpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIG5hbWUgPSBjdXJyZW50SXRlbURhdGEudGV4dHMubmFtZTMKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBsZXQgbWFudWZhY3R1cmVyID0gJyc7CgogICAgICAgICAgICAgICAgaWYoY3VycmVudEl0ZW1EYXRhLmZpbHRlci5oYXNNYW51ZmFjdHVyZXIgIT09IGZhbHNlKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBtYW51ZmFjdHVyZXIgPSBjdXJyZW50SXRlbURhdGEuaXRlbS5tYW51ZmFjdHVyZXIubmFtZQogICAgICAgICAgICAgICAgfQoKCiAgICAgICAgICAgICAgICBsZXQgb2JqZWN0ID0gewogICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOmN1cnJlbnRJdGVtRGF0YS5hdHRyaWJ1dGVzLAogICAgICAgICAgICAgICAgICBpdGVtSWQ6Y3VycmVudEl0ZW1EYXRhLnZhcmlhdGlvbi5pdGVtSWQsCiAgICAgICAgICAgICAgICAgIHZhcklkOiByZXNwb25zZS5kYXRhLmR5bmFtaWNFbnRyaWVzLmVudHJpZXNbaV0uaWQsCiAgICAgICAgICAgICAgICAgIGl0ZW1OYW1lOm5hbWUsCiAgICAgICAgICAgICAgICAgIG1hbnVmYWN0dXJlcjptYW51ZmFjdHVyZXIsCiAgICAgICAgICAgICAgICAgIGltYWdlOmltYWdlLAogICAgICAgICAgICAgICAgICBleHRlcm5hbElkOmN1cnJlbnRJdGVtRGF0YS52YXJpYXRpb24uZXh0ZXJuYWxJZCwKICAgICAgICAgICAgICAgICAgdmFyTnVtYmVyOmN1cnJlbnRJdGVtRGF0YS52YXJpYXRpb24ubnVtYmVyLAogICAgICAgICAgICAgICAgICBjbGllbnQ6Y3VycmVudEl0ZW1EYXRhLmlkcy5jbGllbnRzLAogICAgICAgICAgICAgICAgICBpc1NlbGVjdGFibGU6dHJ1ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJlcGxhY2VUYWJsZS5wdXNoKG9iamVjdCkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKHJlcGxhY2VUYWJsZS5sZW5ndGggPT0gMCkKICAgICAgICAgICAgewogICAgICAgICAgICAgIF9zZWxmLmFsZXJ0cy5kYXNoYm9hcmRTZWFyY2guaXNBY3RpdmUgPSB0cnVlOwogICAgICAgICAgICAgIF9zZWxmLmFsZXJ0cy5kYXNoYm9hcmRTZWFyY2gudHlwZSA9ICdyZ2IoMjM1LCAxNTMsIDUyKSc7CiAgICAgICAgICAgICAgX3NlbGYuYWxlcnRzLmRhc2hib2FyZFNlYXJjaC5tZXNzYWdlID0gIkVzIGtvbm50ZW4ga2VpbmUgRXJnYm5pc3NlIGbDvHIgZGllIFN1Y2hlIGdlZnVuZGVuIHdlcmRlbiIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX3NlbGYuZGFzaGJvYXJkQ3Jvc3NTZWxsZXIgPSByZXBsYWNlVGFibGU7CgogICAgICAgICAgICBfc2VsZi5sb2FkaW5nLmRhc2hib2FyZCA9IGZhbHNlOwoKICAgICAgICAgICAgX3NlbGYubG9hZGluZy5kYXNoYm9hcmRTZWFyY2ggPSBmYWxzZTsKCiAgICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgICAgICBfc2VsZi5sb2FkaW5nLmRhc2hib2FyZFNlYXJjaCA9IGZhbHNlOwogICAgICAgICAgfSkKICAgICAgICB9LAogICAgICB9LAp9Owo="},{"version":3,"sources":["Main.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"Main.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <v-main style=\"background: #f1f1f1\" >\n      <v-toolbar height=\"48px\" v-if=\"mainTabs == 0\">\n        <plenty-input-search  :search=\"searchSelect\"   style=\"height: 32px\" :filter=\"searchFilterInputSearch\" v-on:filterupdate=\"filterUpdaten($event)\" v-on:searchselect=\"searchSelectUpdate($event)\" :actions=\"actions\"></plenty-input-search>\n      </v-toolbar>\n      <template v-else>\n        <v-toolbar height=\"48px\">\n        </v-toolbar>\n      </template>\n      <v-container fluid style=\"background: #f1f1f1\"  >\n        <div style=\"background: #fff\" class=\"mt-1 pa-3\">\n          <v-row >\n            <v-col cols=\"12\" class=\"pa-0 ma-0\">\n              <v-tabs  style=\"background-color: rgb(241, 241, 241);!important;\" v-model=\"mainTabs\">\n                <v-tab  :class=\"{'activeTab':mainTabs == 0 }\" >\n                  Dashboard\n                </v-tab>\n                <v-tab :class=\"{'activeTab':mainTabs == 1 }\">\n                  Cross Seller anlegen\n                </v-tab>\n                <v-tab  disabled :class=\"{'activeTab':mainTabs == 2 }\">\n                  Suche\n                </v-tab>\n              </v-tabs>\n            </v-col>\n          </v-row>\n          <v-row class=\"h-100 elevation-2\">\n            <v-col cols=\"12\">\n              <template v-if=\"mainTabs == 0\">\n                <v-data-table\n                    :loading=\"loading.dashboardSearch\"\n                    :headers=\"searchResultHeader\"\n                    @click:row=\"searchingVariantToSelect = true;setCrossSellerController($event)\"\n                    :items=\"dashboardCrossSeller\"\n                    :footer-props=\"{'items-per-page-options':[15, 50, 100]}\"\n                    :sort-desc=\"options.orderDesc\"\n                    :options=\"options\"\n                    :server-items-length=\"totalCrossSeller\"\n                    v-on:update:options=\"updateData($event)\"\n                    item-key=\"cartId\"\n                    :items-per-page=\"15\"\n                >\n\n                  <template v-slot:item.image=\"{ item }\">\n                    <v-avatar>\n                      <img :src=\"item.image\" class=\"img-fluid\" style=\"height: 75px\">\n                    </v-avatar>\n                  </template>\n                </v-data-table>\n              </template>\n              <template v-else-if=\"mainTabs == 1\">\n                <v-row>\n                  <v-col cols=\"6\">\n                    <v-card class=\"elevation-0\">\n                      <v-card-title >\n                        <div  class=\"flex-fill d-flex\" style=\"margin-bottom: 5px\">\n                          <v-text-field\n                              outlined\n                              readonly\n                              @click=\"searchingVariantToSelect = true;resetSearch()\"\n                              v-model=\"selectedVariation.varId\"\n                              label=\"Varianten Id\"\n                              class=\"mb-0 pb-0\"\n                          ></v-text-field>\n                          <template v-if=\"selectedVariation.varId > 0\" >\n                            <v-btn class=\"mr-4 mt-2 ml-3\"  style=\"background: rgb(241 241 83);color: white\" @click=\"searchingVariantToSelect = true;resetSearch()\">\n                              <v-icon >\n                                mdi-pencil\n                              </v-icon>\n                            </v-btn>\n                          </template>\n                          <template v-else>\n                            <v-btn class=\"mr-4 mt-2 ml-3\"   color=\"success\" @click=\"searchingVariantToSelect = true;resetSearch()\">\n                              <v-icon>\n                                mdi-magnify\n                              </v-icon>\n                            </v-btn>\n                          </template>\n                          <v-btn class=\"mt-2\"  color=\"warning\"\n                                 @click=\"selectedVariation = {};\n                             currentCrossSeller = []\">\n                            <v-icon>\n                              mdi-arrow-u-left-bottom\n                            </v-icon>\n                          </v-btn>\n                        </div>\n                      </v-card-title>\n                      <template v-if=\"selectedVariation.varId > 0\">\n                        <v-card-text style=\"padding: 12px!important\">\n                          <v-row class=\"mt-1 pa-3\" >\n                            <v-col cols=\"1\" class=\"d-flex\" style=\" align-items: start;\">\n                              <v-avatar style=\"width: unset;height: unset\">\n                                <img :src=\"selectedVariation.image\" class=\"img-fluid\" style=\"max-height: 80px;\">\n                              </v-avatar>\n                            </v-col>\n                            <v-col cols=\"11\">\n                              <v-row>\n                                <v-col cols=\"12\">\n                                  <h3>{{ selectedVariation.itemName }}</h3>\n                                  Varianten-Id: <b>{{ selectedVariation.varId }}</b> / Item-Id: {{ selectedVariation.itemId }} <template v-if=\"selectedVariation.varNumber\"> / Varianten-Nummer: {{ selectedVariation.varNumber}}</template>\n                                  <template v-if=\"selectedVariation.manufacturer !== '' \" >\n                                    Hersteller : {{ selectedVariation.manufacturer }}\n                                  </template>x\n                                  <template>\n                                    <br>\n                                    Attribute:\n                                    <ul v-if=\"selectedVariation.attributes.length > 0\" class=\"list-unstyled list-inline\">\n                                      <li :key=\"selectedVariation.varId+'_attr_'+attribute.value.names.name\"  v-for=\"attribute in selectedVariation.attributes\">\n                                        <span  class=\"font-weight-bold\" v-html=\"attribute.attribute.names.name\"></span>: <span v-html=\"attribute.value.names.name\"></span>\n                                      </li>\n                                    </ul>\n                                  </template>\n                                </v-col>\n                              </v-row>\n                            </v-col>\n                          </v-row>\n                        </v-card-text>\n                      </template>\n                    </v-card>\n                  </v-col>\n                  <v-col cols=\"6\">\n                    <v-card class=\"elevation-0\">\n                      <v-card-title>\n                        Verknüpfte Cross Seller\n                        <div class=\"d-flex align-center\">\n                          <v-btn @click=\"searchingVariantToSelect = false;resetSearch()\" :disabled=\"selectedVariation.varId == undefined \" class=\"mr-4 mt-2\" style=\"margin-left: 15px;margin-bottom: 5px\"  color=\"success\">\n                            <v-icon>\n                              mdi-plus\n                            </v-icon>\n                          </v-btn>\n                          <v-btn :disabled=\"currentCrossSeller.length < 1\" @click=\"modal.deleteAll = true\" class=\"mr-4 mt-2\" style=\"margin-left: 15px;margin-bottom: 5px\"  color=\"error\">\n                            <v-icon>\n                              mdi-delete-outline\n                            </v-icon>\n                          </v-btn>\n                        </div>\n\n                      </v-card-title>\n                      <v-card-text  class=\"colorList\" v-if=\"loading.crossSeller == false\" style=\"padding: 12px!important\">\n                        <template v-for=\"(crossSeller,index) in currentCrossSeller\">\n                          <v-row :key=\"'delete_'+crossSeller.varId\" class=\"mt-1 pa-3 coloredRow\" >\n                            <template v-if=\"currentCrossSeller.length > 0\">\n                              <v-col cols=\"2\" class=\"d-flex \">\n                                <div style=\"display: flex;flex-direction: column; align-items: center;\">\n                                  <v-btn :disabled=\"currentCrossSeller.indexOf(crossSeller) == 0\" class=\"position-btn mb-1\" @click=\"recalcPostitions(crossSeller,index-1)\">\n                                    <v-icon>\n                                      mdi-arrow-up-circle-outline\n                                    </v-icon>\n                                  </v-btn>\n                                  <template>\n                                  </template>\n                                  <v-btn  :disabled=\"currentCrossSeller.indexOf(crossSeller)  == currentCrossSeller.length-1\" class=\"position-btn\" @click=\"recalcPostitions(crossSeller,index+1)\">\n                                    <v-icon>\n                                      mdi-arrow-down-circle-outline\n                                    </v-icon>\n                                  </v-btn>\n                                </div>\n                                <div class=\"ml-2 mt-1\">\n                                  <v-text-field\n                                      type=\"number\"\n                                      label=\"Position\"\n                                      :value=\"index+1\"\n                                      style=\"width: 64px\"\n                                      :disabled=\"currentCrossSeller.length < 2\"\n                                      @change=\"recalcPostitions(crossSeller,$event-1)\"\n                                      :rules=\"[rules.notSame, rules.greaterZero]\"\n                                      :loading=\"loading.position\"\n                                  ></v-text-field>\n                                </div>\n                              </v-col>\n                            </template>\n                            <v-col cols=\"1\" class=\"d-flex\" style=\" align-items: start;\">\n                              <v-avatar style=\"width: unset;height: unset\">\n                                <img :src=\"crossSeller.image\" class=\"img-fluid\" style=\"max-height: 80px;\">\n                              </v-avatar>\n                            </v-col>\n                            <v-col cols=\"7\">\n                              <v-row>\n                                <v-col cols=\"12\">\n                                  <h3>{{ crossSeller.itemName }}</h3>\n                                  Varianten-Id: <b>{{ crossSeller.varId }}</b> / Item-Id: {{ crossSeller.itemId }} <template v-if=\"crossSeller.varNumber\"> / Varianten-Nummer: {{ crossSeller.varNumber}}</template>\n                                  <template v-if=\"crossSeller.manufacturer !== '' \" >\n                                    Hersteller : {{ crossSeller.manufacturer }}\n                                  </template>x\n                                  <template>\n                                    <br>\n                                    Attribute:\n                                    <ul v-if=\"crossSeller.attributes.length > 0\" class=\"list-unstyled list-inline\">\n                                      <li  :key=\"crossSeller.varId+'_attr_'+index\" v-for=\"(attribute,index) in crossSeller.attributes\">\n                                        <span class=\"font-weight-bold\" v-html=\"attribute.attribute.names.name\"></span>: <span v-html=\"attribute.value.names.name\"></span>\n                                      </li>\n                                    </ul>\n                                  </template>\n                                </v-col>\n                              </v-row>\n                            </v-col>\n                            <v-col cols=\"1\" class=\"d-flex align-center\">\n                              <v-btn class=\"badge-btn\"  color=\"error\" @click=\"deleteCrossSeller([crossSeller])\">\n                                <v-icon>\n                                  mdi-delete-outline\n                                </v-icon>\n                              </v-btn>\n                            </v-col>\n                          </v-row>\n                        </template>\n                      </v-card-text>\n                      <v-card-text class=\"d-flex justify-center mt-3\" v-else>\n                        <v-progress-circular style=\"width: 50px;height: 50px\" color=\"blue lighten--1\" indeterminate>\n\n                        </v-progress-circular>\n                      </v-card-text>\n                    </v-card>\n                  </v-col>\n                </v-row>\n              </template>\n              <template v-else-if=\"mainTabs == 2\" >\n                <div class=\"row pa-2\">\n                  <v-col cols=\"2\">\n                    <div  class=\"d-flex flex-column elevation-1\" style=\"width: 100%\">\n                      <v-tabs\n                          style=\"background: #F5F5F5!important;\"\n                          v-model=\"tabSearch\"\n                          fixed-tabs\n                      >\n                        <v-tab>\n                          Filter\n                        </v-tab>\n                        <v-tab>\n                          Kategorie\n                        </v-tab>\n                      </v-tabs>\n                      <template v-if=\"tabSearch == 0\">\n                        <v-list-item>\n                          <v-row>\n                            <v-col cols=\"2\" >\n                              <button class=\"filter-icon\" :class=\"{'disabledSearch':loading.search == true }\" :disabled=\"loading.search\" @click=\"search()\" style=\"border-bottom: 4px solid rgb(63, 84, 208);\">\n                                <v-icon color=\"white\" v-if=\"loading.search == false\">\n                                  mdi-magnify\n                                </v-icon>\n                                <v-progress-circular style=\"width: 24px;height: 24px\" color=\"white\" v-else indeterminate>\n\n                                </v-progress-circular>\n                              </button>\n                            </v-col>\n                            <v-col cols=\"2\">\n                              <button class=\"filter-icon\" @click=\"resetSearch()\"\n                                      style=\"border-bottom: 4px solid rgb(255,135,62);\">\n                                <v-icon color=\"white\">\n                                  mdi-arrow-u-left-top\n                                </v-icon>\n                              </button>\n                            </v-col>\n                          </v-row>\n                        </v-list-item>\n                        <v-list-item  v-if=\"searchFilter.categories.length > 0\">\n                          <v-list-item-title>\n                            <v-checkbox\n                                v-model=\"useCategories\"\n                                label=\"Mit Kategorien suchen\"\n                            ></v-checkbox>\n                          </v-list-item-title>\n                        </v-list-item>\n                        <v-list-item>\n                          <v-list-item-title>\n                            <v-text-field\n                                label=\"Artikel-Id\"\n                                hide-details=\"auto\"\n                                type=\"number\"\n                                @keydown.enter=\"search()\"\n                                v-model=\"searchFilter.itemId\"\n                            >\n                            </v-text-field>\n                          </v-list-item-title>\n                        </v-list-item>\n                        <v-list-item>\n                          <v-list-item-title>\n                            <v-text-field\n                                label=\"Varianten-Id\"\n                                hide-details=\"auto\"\n                                type=\"number\"\n                                @keydown.enter=\"search()\"\n                                v-model=\"searchFilter.varId\"\n                            >\n                            </v-text-field>\n                          </v-list-item-title>\n                        </v-list-item>\n                        <v-list-item>\n                          <v-list-item-title>\n                            <v-text-field\n                                label=\"Variantennummer\"\n                                hide-details=\"auto\"\n                                @keydown.enter=\"search()\"\n                                v-model=\"searchFilter.varNumber\"\n                            >\n                            </v-text-field>\n                          </v-list-item-title>\n                        </v-list-item>\n                        <v-list-item>\n                          <v-list-item-title>\n                            <v-text-field\n                                label=\"Artikeldaten\"\n                                hide-details=\"auto\"\n                                type=\"text\"\n                                @keydown.enter=\"search()\"\n                                v-model=\"searchFilter.itemData\"\n                            >\n                            </v-text-field>\n                          </v-list-item-title>\n                        </v-list-item>\n                        <v-list-item>\n                          <v-list-item-title>\n                            <v-select\n                                :items=\"selectItems.manufacturer\"\n                                v-model=\"searchFilter.manufacturer\"\n                                label=\"Hersteller\"\n                                multiple\n                            >\n                            </v-select>\n                          </v-list-item-title>\n                        </v-list-item>\n                        <v-list-item>\n                          <v-list-item-title>\n                            <v-select\n                                :items=\"selectItems.mandant\"\n                                v-model=\"searchFilter.mandant\"\n                                label=\"Mandant\"\n                                multiple\n                            >\n                            </v-select>\n                          </v-list-item-title>\n                        </v-list-item>\n                        <v-list-item >\n                          <v-list-item-title>\n                            <v-select\n                                :items=\"selectItems.isActive\"\n                                v-model=\"searchFilter.isActive\"\n                                label=\"Aktiv\"\n                            >\n                            </v-select>\n                          </v-list-item-title>\n                        </v-list-item>\n                        <v-list-item class=\"mb-3 mt-2\">\n                          <v-select\n                              v-model=\"selectedTags\"\n                              :items=\"tags\"\n                              label=\"Tags\"\n                              multiple\n                              persistent-hint\n                          >\n                            <template   v-slot:item=\"{ item }\">\n                              <div>\n                                <v-badge\n                                    class=\"ml-1\"\n                                    left\n                                    :color=\"item.color\"\n\n                                ></v-badge>\n                                <span  class=\"ml-1\"> {{ item.tagName }} </span>\n                              </div>\n                            </template>\n                            <template v-slot:selection=\"{ item ,index }\">\n                              <template v-if=\"selectedTags.length > 2 && index == 2\">\n                                <v-chip class=\"ml-4 my-3\">\n                                  (+ {{ selectedTags.length-2 }} Other )\n                                </v-chip>\n                              </template>\n                              <template v-else-if=\"index < 2\">\n                                <div class=\"ml-4 my-3\">\n                                  <v-badge\n                                      class=\"ml-1\"\n                                      left\n                                      :color=\"item.color\"\n\n                                  ></v-badge>\n                                  <span  class=\"ml-1\"> {{ item.tagName }} </span>\n                                </div>\n                              </template>\n                            </template>\n\n                          </v-select>\n                        </v-list-item>\n                        <v-list-item>\n                          <v-select\n                              v-model=\"searchFilter.mark1\"\n                              :items=\"mark1Items\"\n                              label=\"Markierung 1\"\n                          >\n                          </v-select>\n                        </v-list-item>\n                        <v-list-item>\n                          <v-select\n                              v-model=\"searchFilter.mark2\"\n                              :items=\"mark2Items\"\n                              label=\"Markierung 2\"\n                          >\n                          </v-select>\n                        </v-list-item>\n                      </template>\n                      <template v-else>\n                        <button class=\"filter-icon ml-6 mt-2\" @click=\"searchFilter.categories = []\"\n                                style=\"border-bottom: 4px solid rgb(255,135,62);width: 34px;height: 36px\">\n                          <v-icon color=\"white\">\n                            mdi-arrow-u-left-top\n                          </v-icon>\n                        </button>\n                        <v-treeview\n\n                            selectable\n                            v-model=\"searchFilter.categories\"\n                            hoverable\n                            return-object\n                            :items=\"categoryTree\"\n                            open-on-click:true\n                        ></v-treeview>\n                      </template>\n                    </div>\n                  </v-col>\n                  <v-col cols=\"10\">\n                    <div class=\"loadingBackDrop\" v-if=\"loading.add == true\">\n                      <v-progress-circular style=\"width: 200px;height: 200px;\" color=\"blue lighten--1 \" indeterminate>\n                      </v-progress-circular>\n                    </div>\n                    <div class=\" flex-fill\">\n                      <v-data-table\n                          @click:row=\"setCrossSellerController($event)\"\n                          :loading=\"loading.search\"\n                          :headers=\"searchResultHeader\"\n                          :disabled=\"loading.add\"\n                          :options=\"searchOptions\"\n                          :items=\"searchResults\"\n                          :footer-props=\"{'items-per-page-options':[15, 50, 100]}\"\n                          item-key=\"varId\"\n                          v-model=\"selected\"\n                          :server-items-length=\"searchResultsTotal\"\n                          :item-class=\"setClassAlreadyCrossSeller\"\n                          :show-select=\"searchingVariantToSelect !== true\"\n                          v-on:update:options=\"search($event)\"\n                          >\n\n                        <template v-slot:top v-if=\"searchingVariantToSelect !== true\">\n                          <v-btn color=\"success\" class=\"ma-2\" :disabled=\"selected.length <= 0\" @click=\"addNewCrossSeller(selected)\">\n                            <v-icon>\n                              mdi-plus\n                            </v-icon>\n                            Cross Seller hinzufügen\n                          </v-btn>\n                        </template>\n                        <template v-slot:item.image=\"{ item }\">\n                          <v-avatar>\n                            <img :src=\"item.image\" class=\"img-fluid\" style=\"height: 75px\">\n                          </v-avatar>\n                        </template>\n                        <template v-slot:item.tags=\"{ item }\">\n                          <template v-for=\"tag in item.tags\">\n                            <div class=\"ml-4 my-3\" :key=\"item.varId +'_tag_'+tag.tagId\">\n                              <v-badge\n                                  class=\"ml-1\"\n                                  left\n                                  :color=\"tag.tag.color\"\n                              ></v-badge>\n                              <span  class=\"ml-1\"> {{ tag.tag.tagName }} </span>\n                            </div>\n                          </template>\n                        </template>\n                      </v-data-table>\n                    </div>\n                  </v-col>\n\n\n                </div>\n              </template>\n            </v-col>\n          </v-row>\n        </div>\n\n      </v-container>\n    </v-main>\n    <v-snackbar\n        right\n        top\n        :color=\"alerts.add.type\"\n        elevation=\"15\"\n        :timeout=\"3000\"\n        v-model=\"alerts.add.isActive\"\n    >\n      {{ alerts.add.message }}\n    </v-snackbar>\n    <v-snackbar\n        top\n        :color=\"alerts.search.type\"\n        :timeout=\"3000\"\n        elevation=\"15\"\n        v-model=\"alerts.search.isActive\"\n        right\n    >\n      {{ alerts.search.message }}\n    </v-snackbar>\n    <v-snackbar\n        top\n        right\n        elevation=\"15\"\n        :color=\"alerts.delete.type\"\n        :timeout=\"3000\"\n        v-model=\"alerts.delete.isActive\"\n    >\n      {{ alerts.delete.message }}\n    </v-snackbar>\n    <v-snackbar\n        top\n        right\n        elevation=\"15\"\n        :color=\"alerts.position.type\"\n        :timeout=\"3000\"\n        v-model=\"alerts.position.isActive\"\n    >\n      {{ alerts.position.message }}\n    </v-snackbar>\n    <v-snackbar\n        top\n        right\n        elevation=\"15\"\n        :color=\"alerts.dashboardSearch.type\"\n        :timeout=\"3000\"\n        v-model=\"alerts.dashboardSearch.isActive\"\n    >\n      {{ alerts.dashboardSearch.message }}\n    </v-snackbar>\n    <v-col cols=\"auto\">\n      <v-dialog\n          transition=\"dialog-top-transition\"\n          max-width=\"600\"\n          v-model=\"modal.deleteAll\"\n      >\n        <v-card>\n          <v-toolbar color=\"error\" class=\"text-h6\" dark>\n            Alle Verknüpften Cross Seller löschen\n          </v-toolbar>\n          <v-card-text>\n            <div class=\"text-h5 pa-5\"> Löscht alle Verknüpfungen für Cross Seller an der Variante: <br> <b>{{ selectedVariation.varId }} - {{ selectedVariation.itemName }}</b></div>\n          </v-card-text>\n          <v-card-actions class=\"justify-end\">\n            <v-btn color=\"error\" @click=\"deleteCrossSeller(currentCrossSeller);modal.deleteAll = false\">\n              <v-icon>\n                mdi-delete\n              </v-icon>\n              Löschen\n            </v-btn>\n            <v-btn color=\"primary\"  @click=\"modal.deleteAll = false\">\n              Abbrechen\n            </v-btn>\n          </v-card-actions>\n        </v-card>\n      </v-dialog>\n    </v-col>\n  </div>\n\n</template>\n\n<script>\nimport PlentyInputSearch from \"./Input/plentyInputSearch\";\nexport default {\n  name: 'Main',\n  components: {PlentyInputSearch},\n  data: () => (\n      {\n        rules: {\n          notSame: value => value == value,\n          greaterZero: value => value > 0 ,\n        },\n        searchResultsTotal:0,\n        useCategories:true,\n        mark1Items:['',\"Ohne\",1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31],\n        mark2Items:['',\"Ohne\",1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],\n        tags:[],\n        selectedTags:[],\n        totalCrossSeller:0,\n        modal:\n        {\n          deleteAll:false\n        },\n        searchOptions:{\n          page:1,\n          itemsPerPage:15,\n        },\n        options:\n        {\n          page:1,\n          itemsPerPage:15,\n          orderBy:'varId',\n          filter:[],\n        },\n        actions:\n        {\n          focusSearch: false,\n          focusFilter: false\n        },\n        searchSelect:\n        [\n          {\n            \"key\": \"varId\",\n            \"name\": 'Varianten Id:',\n            \"operator\": \"=\",\n            \"value\": '',\n          },\n          {\n            \"key\": \"itemId\",\n            \"name\": 'Artikel Id:',\n            \"operator\": \"=\",\n            \"value\": '',\n          },\n          {\n            \"key\": \"varNumber\",\n            \"name\": 'Varianten Nummer:',\n            \"operator\": \"=\",\n            \"value\": '',\n          },\n          {\n            \"key\": \"varName\",\n            \"name\": 'Varianten Name:',\n            \"operator\": \"=\",\n            \"value\": '',\n          }\n\n        ],\n        searchFilterInputSearch:\n        [\n        ],\n        mainTabs: 0,\n        tabSearch: 0,\n        categoryTree: [],\n        selectItems: {\n          mandant: [],\n          manufacturer: [],\n          isActive:[\n            'ALLE',\n            'JA',\n            'NEIN'\n          ]\n        },\n        mandantMap: {},\n        manufacturerMap: {},\n        selectedVariation:\n            {\n            },\n        searchingVariantToSelect:false,\n        currentCrossSeller:[],\n        searchResultHeader:\n            [\n              {\n                text:'',\n                sortable: false,\n                value:'image'\n              },\n              {\n                text: 'Varianten-Id',\n                sortable: true,\n                value: 'varId',\n              },\n              {\n                text: 'Artikel-Id',\n                sortable: true,\n                value: 'itemId',\n              },\n              {\n                text: 'Name',\n                sortable: false,\n                value: 'itemName',\n              },\n              {\n                text: 'tags',\n                sortable: false,\n                value: 'tags',\n              },\n              {\n                text:'Hersteller',\n                sortable: false,\n                value:'manufacturer'\n              }\n            ],\n        searchResults:[],\n        searchFilter:\n            {\n              categories:[],\n              itemId:null,\n              varId:null,\n              varNumber:null,\n              itemData:'',\n              manufacturer:0,\n              mandant:0,\n              isActive:'JA',\n              mark1:-1,\n              mark2:-1\n            },\n        loading:{\n          dynamicGet:false,\n          crossSeller:false,\n          dashboard:true,\n          search:false,\n          delete:false,\n          add:false,\n          position:false,\n          dashboardSearch:false\n        },\n        selected:[],\n        dashboardCrossSeller:[],\n        alerts: {\n          dashboardSearch:\n          {\n            message:'',\n                isActive:false,\n              type:''\n          },\n          add: {\n            message:'',\n            isActive:false,\n            type:''\n          },\n          search:{\n            message:'',\n            isActive:false,\n            type:''\n          },\n          delete:{\n            message:'',\n            isActive:false,\n            type:''\n          },\n          position:{\n            message:'',\n            isActive:false,\n            type:''\n          }\n        }\n      }),\n  watch:\n      {\n\n      },\n  created() {\n\n    this.getInitialData()\n\n  },\n  methods:\n      {\n        setClassAlreadyCrossSeller(item)\n        {\n          if(this.alreadyCrossSeller(item.varId) == true && this.searchingVariantToSelect !== true  ||  item.varId == this.selectedVariation.varId)\n          {\n            return 'alreadyCrossSeller'\n          }\n          else{\n            return ''\n          }\n        },\n        alreadyCrossSeller(varId)\n        {\n          for(let i = 0; i < this.currentCrossSeller.length; i++)\n          {\n            if(varId == this.currentCrossSeller[i].varId)\n            {\n              return true;\n            }\n          }\n          return false;\n        },\n        deleteCrossSeller(vars)\n        {\n          let _self = this;\n\n          let data = {\n            deleteFrom:_self.selectedVariation.varId,\n            toDelete:[]\n          }\n\n          let replace  = [];\n\n\n          for(let i = 0; i < vars.length; i++)\n          {\n            data.toDelete.push(vars[i])\n          }\n\n          for(let i = 0 ; i < this.currentCrossSeller.length ; i++)\n          {\n            for(let a = 0 ; a <  data.toDelete.length ; a++)\n            {\n              if(this.currentCrossSeller[i].varId == data.toDelete[a].varId)\n              {\n                this.currentCrossSeller.splice(i,1)\n              }\n            }\n          }\n\n\n          _self.$http.post( process.env.VUE_APP_DELETE_CROSSSELLER+process.env.VUE_APP_PLUGIN_SET_PREVIEW,data).then((response) => {\n            if(response)\n            {\n              _self.alerts.delete.isActive = true;\n              _self.alerts.delete.type = 'success';\n              _self.alerts.delete.message = \"Cross Seller wurde erfolgreich gelöscht\"\n            }\n          }).catch((error) => {\n            _self.alerts.delete.isActive = true;\n            _self.alerts.delete.type = 'error';\n            _self.alerts.delete.message = \"Cross Seller konnten nicht gelöscht werden\"\n          })\n        },\n        resetSearch()\n        {\n          this.selected = [];\n          this.searchResults = [];\n          this.searchFilter = {\n            categories:[],\n            itemId:null,\n            varId:null,\n            varNumber:null,\n            itemData:'',\n            manufacturer:0,\n            mandant:0,\n            isActive:'JA',\n            mark2:-1,\n            mark1:-1\n          }\n\n          this.mainTabs = 2;\n        },\n        setCrossSellerController(event)\n        {\n          let _self = this;\n\n          if(_self.searchingVariantToSelect == true){\n            if(event.isSelectable == true) {\n              this.setNewVariant(event)\n            }\n          }\n          else{\n            if(event.isSelectable == true)\n            {\n              this.addNewCrossSeller([event])\n            }\n          }\n\n        },\n        setNewVariant(data)\n        {\n          this.getCrossSellerById(data.varId)\n        },\n        addNewCrossSeller(vars)\n        {\n          let _self = this;\n\n          _self.loading.add = true;\n\n          let data = {\n            addTo:{\n              varId:_self.selectedVariation.varId,\n              itemId:_self.selectedVariation.itemId,\n              itemName:_self.selectedVariation.itemName,\n              manufacturer:_self.selectedVariation.manufacturer,\n              externalVarId:_self.selectedVariation.externalId,\n              varNumber:_self.selectedVariation.varNumber,\n              client:_self.selectedVariation.client\n            },\n            toAdd:[]\n          }\n\n          let highestPos = 0;\n\n          for(let i = 0 ; i <  _self.currentCrossSeller.length ; i++)\n          {\n            if(_self.currentCrossSeller[i].position > highestPos)\n            {\n              highestPos = _self.currentCrossSeller[i].position;\n            }\n          }\n\n          for(let i = 0; i < vars.length; i++)\n          {\n            data.toAdd.push(\n                {\n                  varId:vars[i].varId,\n                  position:highestPos+1\n                }\n            )\n\n            vars[i].position = highestPos+1;\n\n            highestPos++;\n          }\n\n          _self.$http.post( process.env.VUE_APP_ADD_CROSSSELLER+process.env.VUE_APP_PLUGIN_SET_PREVIEW,data).then((response) => {\n            if(response)\n            {\n              _self.mainTabs = 1;\n              _self.alerts.add.isActive = true;\n              _self.loading.add = false;\n              _self.alerts.add.type = 'success';\n              _self.alerts.add.message = \"Cross Seller wurden erfolgreich verknüpft\"\n              _self.getCrossSellerById(_self.selectedVariation.varId)\n            }\n          }).catch((error) => {\n            _self.loading.add = false;\n            _self.alerts.add.type = 'error';\n            _self.alerts.add.isActive = true;\n            _self.alerts.add.message = \"Cross Seller konnten nicht verknüpft werden\"\n            // _self.myAlerts.error = true;\n            // _self.myAlerts.errorMessage = error\n            // _self.resetErorr();\n          })\n        },\n        getCrossSellerById(varId)\n        {\n          let _self = this;\n\n          _self.loading.crossSeller = true;\n\n          _self.currentCrossSeller = [];\n\n          _self.mainTabs = 1;\n\n          _self.$http.get( process.env.VUE_APP_GET_CROSSSELLER+varId+'/'+'de'+'/'+0+process.env.VUE_APP_PLUGIN_SET_PREVIEW).then((response) => {\n            if(response)\n            {\n              console.log('crossbyid',response)\n              let selectVar = response.data.selectedVar.data;\n\n              let image = '';\n\n              if(selectVar.images.variation.length > 0)\n              {\n                let varImages  = selectVar.images.variation[0];\n\n                if(varImages.urlPreview !== '')\n                {\n                  image = varImages.urlPreview\n                }\n                else if(varImages.urlSecondPreview == '')\n                {\n                  image = varImages.urlSecondPreview\n                }\n                else if(varImages.urlMiddle == '')\n                {\n                  image = varImages.urlMiddle\n                }\n              }\n              else if(selectVar.images.all.length > 0)\n              {\n                let allImages  = selectVar.images.all[0];\n\n                if(allImages.urlPreview !== '')\n                {\n                  image = allImages.urlPreview\n                }\n                else if(allImages.urlSecondPreview == '')\n                {\n                  image = allImages.urlSecondPreview\n                }\n                else if(allImages.urlMiddle == '')\n                {\n                  image = allImages.urlMiddle\n                }\n              }\n\n              let name  = '';\n\n              if(selectVar.texts.name1 !== \"N / A\")\n              {\n                name = selectVar.texts.name1\n              }\n              else if(selectVar.texts.name2 !== 'N / A')\n              {\n                name = selectVar.texts.name2\n              }\n              else if(selectVar.texts.name3 !== 'N / A')\n              {\n                name = selectVar.texts.name3\n              }\n              let manufacturer = '';\n\n              if(selectVar.filter.hasManufacturer !== false)\n              {\n                manufacturer = selectVar.item.manufacturer.name\n              }\n              _self.selectedVariation =\n                  {\n                    attributes:selectVar.attributes,\n                    itemId:selectVar.variation.itemId,\n                    varId:selectVar.variation.id,\n                    itemName:name,\n                    manufacturer:manufacturer,\n                    image:image,\n                    externalId:selectVar.variation.externalId,\n                    varNumber:selectVar.variation.number,\n                    client:selectVar.ids.clients\n                  }\n\n              if(response.data && response.data.vars.length > 0 )\n              {\n                for(let i = 0 ; i < response.data.vars.length ; i++)\n                {\n                  let currentItemData = response.data.vars[i].data;\n\n                  let image = '';\n\n                  if(currentItemData.images.variation.length > 0)\n                  {\n                    let varImages  = currentItemData.images.variation[0];\n\n                    if(varImages.urlPreview !== '')\n                    {\n                      image = varImages.urlPreview\n                    }\n                    else if(varImages.urlSecondPreview == '')\n                    {\n                      image = varImages.urlSecondPreview\n                    }\n                    else if(varImages.urlMiddle == '')\n                    {\n                      image = varImages.urlMiddle\n                    }\n                  }\n                  else if(currentItemData.images.all.length > 0)\n                  {\n                    let allImages  = currentItemData.images.all[0];\n\n                    if(allImages.urlPreview !== '')\n                    {\n                      image = allImages.urlPreview\n                    }\n                    else if(allImages.urlSecondPreview == '')\n                    {\n                      image = allImages.urlSecondPreview\n                    }\n                    else if(allImages.urlMiddle == '')\n                    {\n                      image = allImages.urlMiddle\n                    }\n                  }\n\n                  let name  = '';\n\n                  if(currentItemData.texts.name1 !== \"N / A\")\n                  {\n                    name = currentItemData.texts.name1\n                  }\n                  else if(currentItemData.texts.name2 !== 'N / A')\n                  {\n                    name = currentItemData.texts.name2\n                  }\n                  else if(currentItemData.texts.name3 !== 'N / A')\n                  {\n                    name = currentItemData.texts.name3\n                  }\n\n                  let manufacturer = '';\n\n                  if(currentItemData.filter.hasManufacturer !== false)\n                  {\n                    manufacturer = currentItemData.item.manufacturer.name\n                  }\n\n                  let object = {\n                    itemId:currentItemData.variation.itemId,\n                    varId:response.data.vars[i].id,\n                    itemName:name,\n                    manufacturer:manufacturer,\n                    image:image,\n                    position:response.data.vars[i].position,\n                    externalId:currentItemData.variation.externalId,\n                    varNumber:currentItemData.variation.number,\n                    client:currentItemData.ids.clients,\n                    attributes:currentItemData.attributes\n                  }\n                  _self.currentCrossSeller.push(object)\n                }\n              }\n            }\n            _self.loading.crossSeller = false;\n          }).catch((error) => {\n            _self.loading.crossSeller = false;\n            console.log(error)\n            // _self.myAlerts.error = true;\n            // _self.myAlerts.errorMessage = error\n            // _self.resetErorr();\n          })\n\n        },\n        buildCategoryTreeData(data)\n        {\n          let categories = [];\n\n          for(let i = 0 ; i < data.length ; i++)\n          {\n            let category = {}\n            if(data[i].hasOwnProperty(\"details\") && data[i].details[0].hasOwnProperty(\"name\"))\n            {\n              category.name = data[i].details[0].name\n            }\n            if(data[i].hasOwnProperty(\"id\"))\n            {\n              category.id =  data[i].id;\n            }\n            if(data[i].hasOwnProperty(\"parentCategoryId\"))\n            {\n              category.parentCategoryId =  data[i].parentCategoryId;\n            }\n\n            if(data[i].hasOwnProperty(\"childCount\") && data[i].childCount > 0)\n            {\n              category.children = this.buildChildTree(data[i])\n            }\n            categories.push(category)\n          }\n\n          this.categoryTree = categories\n        },\n        buildChildTree(data)\n        {\n          let children = [];\n\n          for(let i = 0 ; i < data.childCount ; i++)\n          {\n            if(data.children[i])\n            {\n\n              let child = {\n                children: []\n              }\n\n              if(data.children[i].hasOwnProperty(\"id\"))\n              {\n                child.id =  data.children[i].id;\n              }\n              if(data.children[i].hasOwnProperty(\"parentCategoryId\"))\n              {\n                child.parentCategoryId =  data.children[i].parentCategoryId;\n              }\n\n              if(data.children[i].hasOwnProperty(\"details\") && data.children[i].details.length > 0 && data.children[i].details[0].name)\n              {\n                child.name = data.children[i].details[0].name\n              }\n              if(data.children[i].childCount > 0)\n              {\n                child.children = this.buildChildTree(data.children[i])\n              }\n\n              children.push(child)\n            }\n          }\n          return children;\n        },\n        getInitialData()\n        {\n          let _self = this;\n\n          _self.$http.get( process.env.VUE_APP_GET_DATA+'0'+process.env.VUE_APP_PLUGIN_SET_PREVIEW).then((response) => {\n            if(response)\n            {\n\n              let data = response.data\n              _self.buildCategoryTreeData(data.categoryTree)\n\n              _self.tags = []\n              for(let i = 0  ; i < data.tags.length ; i++)\n              {\n                data.tags[i].text  = data.tags[i].tagName\n                data.tags[i].value  = data.tags[i].id\n\n                _self.tags.push(data.tags[i])\n              }\n\n              for(let i = 0 ; i < data.manufacturer.entries.length ; i++)\n              {\n\n                _self.manufacturerMap[data.manufacturer.entries[i].name] = data.manufacturer.entries[i].id\n                _self.selectItems.manufacturer.push(data.manufacturer.entries[i].name)\n              }\n\n              for(let i = 0 ; i < data.webStoreConfig.length ; i++)\n              {\n                _self.mandantMap[data.webStoreConfig[i].name] = data.webStoreConfig[i].storeIdentifier\n                _self.selectItems.mandant.push(data.webStoreConfig[i].name)\n              }\n\n\n\n              _self.searchFilterInputSearch =  [\n                {\n                  \"key\":\"manufacturer\",\n                  \"name\": 'Hersteller:',\n                  \"operator\": \"=\",\n                  \"type\":\"select\",\n                  \"items\":_self.selectItems.manufacturer,\n                },\n                {\n                  \"key\":\"client\",\n                  \"name\": 'Mandant:',\n                  \"operator\": \"LIKE\",\n                  \"type\":\"select\",\n                  \"items\":_self.selectItems.mandant,\n                }]\n            }\n          }).catch((error) => {\n            console.log(error)\n            // _self.myAlerts.error = true;\n            // _self.myAlerts.errorMessage = error\n            // _self.resetErorr();\n          })\n\n        },\n        recalcPostitions(item,index = -1)\n        {\n          console.log('pos',index)\n          if(index > -1) {\n            let _self = this;\n\n            let itemIndex = _self.currentCrossSeller.indexOf(item);\n\n            if (index == 0) {\n              _self.currentCrossSeller.splice(itemIndex, 1);\n              _self.currentCrossSeller.unshift(item)\n            } else if (index > _self.currentCrossSeller.length - 1) {\n              _self.currentCrossSeller.splice(itemIndex, 1)\n              _self.currentCrossSeller.push(item);\n            } else {\n              _self.currentCrossSeller.splice(itemIndex, 1)\n              _self.currentCrossSeller.splice(index, 0, item)\n            }\n\n            let data =\n                {\n                  \"updateOn\": _self.selectedVariation.varId,\n                  \"toUpdate\": []\n                };\n\n            for (let i = 0; i < _self.currentCrossSeller.length; i++)\n            {\n              _self.currentCrossSeller[i].position = i + 1;\n\n              data.toUpdate.push\n              (\n                  {\n                    \"varId\": _self.currentCrossSeller[i].varId,\n                    \"position\": _self.currentCrossSeller[i].position,\n                  }\n              )\n            }\n\n            _self.currentCrossSeller.sort(function (a, b) {\n              let positionA = new Date(a.position)\n              let positionB = new Date(b.position);\n              if (positionA < positionB) return -1;\n              if (positionA > positionB) return 1;\n              return 0;\n            });\n\n\n            _self.$http.post(process.env.VUE_APP_UPDATE_POSITION + process.env.VUE_APP_PLUGIN_SET_PREVIEW, data).then((response) => {\n              if (response) {\n                _self.alerts.position.type = 'success';\n                _self.alerts.position.message = \"Die Positions Änderung war erfolgreich\"\n                _self.alerts.position.isActive = true;\n              }\n            }).catch((error) => {\n              _self.alerts.position.type = 'error';\n              _self.alerts.position.message = \"Die Positions Änderung war NICHT erfolgreich\"\n              _self.alerts.position.isActive = true;\n\n            })\n          }\n        },\n        search(event = {})\n        {\n          let _self = this;\n\n          if(event !== {})\n          {\n            _self.searchOptions.page = event.page;\n            _self.searchOptions.itemsPerPage = event.itemsPerPage;\n          }\n\n          _self.loading.search = true;\n\n          let data = {\n            with:'additionalSkus,attributeValues.attribute,attributeValues.attributeValue,barcodes.barcode,base.item,base.itemSerialNumber,base.feedback,base.characteristics,base.crossSelling,base.texts,base.availability,base.images,base.stock,base.stockStorageLocations,bundleComponents,categories.category,categories.categoryBranch,clients,defaultCategories.category,images.image,markets,marketIdentNumbers,salesPrices.salesPrice,skus,supplier.supplier,timestamps,warehouses.warehouse,unit.unit,tags.tag,base.shippingProfiles,comments,inheritance',\n            page:_self.searchOptions.page,\n            itemsPerPage:_self.searchOptions.itemsPerPage\n          }\n\n\n          if(_self.searchFilter.categories.length > 0 && _self.useCategories == true)\n          {\n            let catIds = [];\n            for(let i = 0 ; i < _self.searchFilter.categories.length ; i++)\n            {\n              catIds.push(_self.searchFilter.categories[i].id)\n            }\n            catIds = catIds.toString()\n\n            data.categoryIds = 'in:'+ catIds\n          }\n          if(_self.searchFilter.varId > 0)\n          {\n            data.ids = 'in:'+_self.searchFilter.varId\n          }\n          if(_self.searchFilter.varNumber > 0)\n          {\n            data.number = 'like:'+_self.searchFilter.varNumber\n          }\n          if(_self.searchFilter.itemId > 0)\n          {\n            data.itemIds = 'in:'+_self.searchFilter.itemId\n          }\n          if(_self.searchFilter.mandant.length >0)\n          {\n            if(_self.searchFilter.mandant.length == 1)\n            {\n              data.clientIds = 'in:'+_self.mandantMap[_self.searchFilter.mandant]\n            }\n            else{\n              data.clientIds = 'in:'\n              for(let i = 0 ; i < _self.searchFilter.mandant.length ; i++)\n              {\n                if(i+1 == _self.searchFilter.mandant.length )\n                {\n                  data.clientIds =  data.clientIds + _self.mandantMap[_self.searchFilter.mandant[i]]\n                }\n                else{\n                  data.clientIds =  data.clientIds + _self.mandantMap[_self.searchFilter.mandant[i]] + ','\n                }\n              }\n            }\n          }\n          if(_self.selectedTags.length >0)\n          {\n            data.tagIds = 'in:'+_self.selectedTags.toString()\n          }\n          if(_self.searchFilter.itemData.length > 0)\n          {\n            data.query = _self.searchFilter.itemData\n          }\n          if(_self.searchFilter.manufacturer.length > 0)\n          {\n            data.anyManufacturerId = []\n            for(let i = 0 ; i < _self.searchFilter.manufacturer.length ; i++)\n            {\n              data.anyManufacturerId.push(_self.manufacturerMap[_self.searchFilter.manufacturer[i]])\n            }\n          }\n          if(_self.searchFilter.isActive !== 'ALLE')\n          {\n            if(_self.searchFilter.isActive == 'JA')\n            {\n              data.isActive = true;\n            }\n            else if( _self.searchFilter.isActive == 'NEIN')\n            {\n              data.isActive = false;\n            }\n          }\n          if(_self.searchFilter.mark2 == \"Ohne\")\n          {\n            data.flag2 = 'in:0'\n          }\n          else if(_self.searchFilter.mark2 > -1)\n          {\n            data.flag2 = 'in:'+_self.searchFilter.mark2;\n          }\n          if(_self.searchFilter.mark1 == \"Ohne\")\n          {\n            data.flag1 = 'in:0'\n          }\n          else if(_self.searchFilter.mark1 > -1)\n          {\n            data.flag1 = 'in:'+_self.searchFilter.mark1;\n          }\n          _self.$http.get(process.env.VUE_APP_GET_VARIATIONS , {params :data}).then((response) =>\n          {\n\n            let replaceTable = []\n\n            if(response && response.data && response.data[\"entries\"].length > 0)\n            {\n              let data = response.data;\n\n              _self.searchResultsTotal = data.totalsCount;\n\n              for(let i = 0 ; i < data[\"entries\"].length ; i++)\n              {\n                let image = ''\n                if(data[\"entries\"][i].base.images.length > 0)\n                {\n                  image = data[\"entries\"][i].base.images[0].urlPreview\n                }\n\n                let name = '';\n                if(data[\"entries\"][i].base.texts.length > 0)\n                {\n\n                  name = data[\"entries\"][i].base.texts[0].name\n                }\n\n                let manufacturer = ''\n\n                for (let [key, value] of Object.entries(_self.manufacturerMap)) {\n                  if(value == data[\"entries\"][i].base.item.manufacturerId)\n                  {\n                    manufacturer = key;\n                  }\n\n                }\n                let clients = []\n\n                for (let [key, value] of Object.entries(_self.mandantMap)) {\n                  for( let a = 0 ; a < data[\"entries\"][i].clients.length ; a++)\n                  {\n                    if(value == data[\"entries\"][i].clients[a])\n                    {\n                      clients.push(value) ;\n                    }\n                  }\n                }\n\n                let object = {\n                  itemId:data[\"entries\"][i].base.itemId,\n                  varId:data[\"entries\"][i].id,\n                  manufacturer:manufacturer,\n                  attributes:data[\"entries\"][i].attributeValues,\n                  image:image,\n                  itemName:name,\n                  externalId:data[\"entries\"][i].base.externalId,\n                  client:clients,\n                  tags:data[\"entries\"][i].tags,\n                  varNumber:data[\"entries\"][i].base.number,\n                  isSelectable:(!_self.alreadyCrossSeller(data[\"entries\"][i].id) && data[\"entries\"][i].id !== _self.selectedVariation.varId) || (_self.searchingVariantToSelect == true && data[\"entries\"][i].id !== _self.selectedVariation.varId)\n                }\n\n                replaceTable.push(object)\n\n                _self.loading.search = false;\n                _self.searchResults = replaceTable\n              }\n\n            }\n            else{\n              _self.loading.search = false;\n              _self.searchResults = replaceTable\n            }\n          }).catch((error) => {\n            console.log(error)\n\n            _self.loading.search = false;\n            _self.searchResults = [];\n\n            _self.alerts.search.isActive = true;\n            _self.alerts.search.message = \"Suche fehlgeschlagen\"\n            _self.alerts.search.type = \"error\"\n            // _self.myAlerts.error = true;\n            // _self.myAlerts.errorMessage = error\n            // _self.resetErorr();\n          })\n        },\n        updateData(event)\n        {\n          let _self   = this;\n\n          _self.options.itemsPerPage  = event.itemsPerPage;\n          _self.options.page          = event.page;\n          _self.options.orderBy       = event.sortBy[0];\n          _self.options.orderDesc     = event.sortDesc[0]\n\n          this.dynamicGet('crossSeller',this.options.itemsPerPage,this.options.page,this.options.orderBy,this.options.orderDesc,this.options.filter)\n        },\n        searchSelectUpdate(event)\n        {\n          let needArray = [];\n          needArray.push(event);\n          this.filterUpdaten(needArray);\n        },\n        filterUpdaten(data)\n        {\n          let filter = [];\n          for(let i = 0; i < data.length; i++ )\n          {\n\n            if(data[i].value != \"\" && data[i].value != null )\n            {\n              let option =\n                  {\n                    \"where\":data[i].key\n                  }\n              if(data[i].type == 'date')\n              {\n                option.value = new Date(data[i].value).getTime()/1000\n              }\n              else\n              {\n                option.value = data[i].value;\n              }\n              if(data[i].type == \"switch\")\n              {\n                option.value = (data[i].value == true) ? 1 : 0;\n              }\n              if(Object.prototype.hasOwnProperty.call(data[i], 'operator'))\n              {\n                option.operator = data[i].operator\n              }\n              if(data[i].key == \"client\")\n              {\n                for (let [key, value] of Object.entries(this.mandantMap)) {\n                  if(data[i].value == key)\n                  {\n                    option.value = '%'+value+'%';\n                  }\n                }\n              }\n              filter.push(option)\n            }\n          }\n          this.options.filter = filter;\n\n          this.dynamicGet('crossSeller',this.options.itemsPerPage,this.options.page,this.options.orderBy,this.options.orderDesc,this.options.filter)\n        },\n        dynamicGet(db = 'crossSeller',itemsPerPage = 20,page = 1,orderBy = 'id',order = 'desc',filter = []) {\n          let _self = this;\n\n          let link = process.env.VUE_APP_DYNAMIC_GET + process.env.VUE_APP_PLUGIN_SET_PREVIEW\n\n          let orderDesc = 'desc';\n\n          let data = {\n            \"db\":db,\n            \"itemsPerPage\":itemsPerPage,\n            \"page\":page,\n            \"orderBy\":orderBy,\n            \"orderDesc\":orderDesc,\n            \"filter\":filter,\n            \"getItemData\":true\n          }\n\n          _self.loading.dashboardSearch = true;\n          _self.dashboardCrossSeller = [];\n\n          _self.$http.post(link,data).then((response) =>\n          {\n            let replaceTable = [];\n\n            if(response.data && response.data.dynamicEntries && response.data.dynamicEntries.entries.length > 0)\n            {\n              _self.totalCrossSeller = response.data.dynamicEntries.itemsTotal;\n\n              for(let i = 0 ; i < response.data.dynamicEntries.entries.length ; i++)\n              {\n                let currentItemData = response.data.dynamicEntries.entries[i].data;\n\n                let image = '';\n\n                if(currentItemData.images.variation.length > 0)\n                {\n                  let varImages  = currentItemData.images.variation[0];\n\n                  if(varImages.urlPreview !== '')\n                  {\n                    image = varImages.urlPreview\n                  }\n                  else if(varImages.urlSecondPreview == '')\n                  {\n                    image = varImages.urlSecondPreview\n                  }\n                  else if(varImages.urlMiddle == '')\n                  {\n                    image = varImages.urlMiddle\n                  }\n                }\n                else if(currentItemData.images.all.length > 0)\n                {\n                  let allImages  = currentItemData.images.all[0];\n\n                  if(allImages.urlPreview !== '')\n                  {\n                    image = allImages.urlPreview\n                  }\n                  else if(allImages.urlSecondPreview == '')\n                  {\n                    image = allImages.urlSecondPreview\n                  }\n                  else if(allImages.urlMiddle == '')\n                  {\n                    image = allImages.urlMiddle\n                  }\n                }\n\n                let name  = '';\n\n                if(currentItemData.texts.name1 !== \"N / A\")\n                {\n                  name = currentItemData.texts.name1\n                }\n                else if(currentItemData.texts.name2 !== 'N / A')\n                {\n                  name = currentItemData.texts.name2\n                }\n                else if(currentItemData.texts.name3 !== 'N / A')\n                {\n                  name = currentItemData.texts.name3\n                }\n\n                let manufacturer = '';\n\n                if(currentItemData.filter.hasManufacturer !== false)\n                {\n                  manufacturer = currentItemData.item.manufacturer.name\n                }\n\n\n                let object = {\n                  attributes:currentItemData.attributes,\n                  itemId:currentItemData.variation.itemId,\n                  varId: response.data.dynamicEntries.entries[i].id,\n                  itemName:name,\n                  manufacturer:manufacturer,\n                  image:image,\n                  externalId:currentItemData.variation.externalId,\n                  varNumber:currentItemData.variation.number,\n                  client:currentItemData.ids.clients,\n                  isSelectable:true\n                }\n\n                replaceTable.push(object)\n              }\n            }\n\n            if(replaceTable.length == 0)\n            {\n              _self.alerts.dashboardSearch.isActive = true;\n              _self.alerts.dashboardSearch.type = 'rgb(235, 153, 52)';\n              _self.alerts.dashboardSearch.message = \"Es konnten keine Ergbnisse für die Suche gefunden werden\"\n            }\n\n            _self.dashboardCrossSeller = replaceTable;\n\n            _self.loading.dashboard = false;\n\n            _self.loading.dashboardSearch = false;\n\n          }).catch((error) => {\n\n            console.log(error)\n            _self.loading.dashboardSearch = false;\n          })\n        },\n      },\n};\n</script>"]}]}